####VOSTOK#
####Cycles#
Holocene.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Holocene")#
Holocene.Cycle.Time.Vostok <- subset(vostok$Cycle.Time.Vostok, vostok$Cycle=="Holocene")#
Holocene.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle =="Holocene")#
Holocene.Data.Density.Vostok <- 1000/length(subset(Holocene.Cycle.Time.Vostok, Holocene.Cycle.Time.Vostok > 1 & Holocene.Cycle.Time.Vostok < 1000))#
Holocene.SMA.Val.Vostok <- 1000/Holocene.Data.Density.Vostok#
Holocene.SMA.Vostok <- SMA(Holocene.Cycle.Temp.Vostok, Holocene.SMA.Val.Vostok)#
#
Eemian.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Eemian")#
Eemian.Cycle.Time.Vostok <- subset(vostok$Cycle.Time.Vostok, vostok$Cycle=="Eemian")#
Eemian.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Eemian")#
Eemian.Data.Density.Vostok <- 1000/length(subset(Eemian.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok > 1 & Eemian.Cycle.Time.Vostok < 1000))#
Eemian.SMA.Val.Vostok <- 1000/Eemian.Data.Density.Vostok#
Eemian.SMA.Vostok <- SMA(Eemian.Cycle.Temp.Vostok, Eemian.SMA.Val.Vostok)#
#
Yarmouth.III.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time.Vostok <- subset(vostok$Cycle.Time.Vostok, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density.Vostok <- 1000/length(subset(Yarmouth.III.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok > 1 & Yarmouth.III.Cycle.Time.Vostok < 1000))#
Yarmouth.III.SMA.Val.Vostok <- 1000/Yarmouth.III.Data.Density.Vostok#
Yarmouth.III.SMA.Vostok <- SMA(Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.III.SMA.Val.Vostok)#
#
Yarmouth.II.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time.Vostok <- subset(vostok$Cycle.Time.Vostok, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density.Vostok <- 1000/length(subset(Yarmouth.II.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok > 1 & Yarmouth.II.Cycle.Time.Vostok < 1000))#
Yarmouth.II.SMA.Val.Vostok <- 1000/Yarmouth.II.Data.Density.Vostok#
Yarmouth.II.SMA.Vostok <- SMA(Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.II.SMA.Val.Vostok)#
#
Yarmouth.I.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time.Vostok <- subset(vostok$Cycle.Time.Vostok, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density.Vostok <- 1000/length(subset(Yarmouth.I.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok > 6952 & Yarmouth.I.Cycle.Time.Vostok < 7952))#
Yarmouth.I.SMA.Val.Vostok <- 1000/Yarmouth.I.Data.Density.Vostok#
Yarmouth.I.SMA.Vostok <- SMA(Yarmouth.I.Cycle.Temp.Vostok, Yarmouth.I.SMA.Val.Vostok)#
vostok.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),#
Time=c(Holocene.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok),#
Temp=c(Holocene.Cycle.Temp.Vostok, Eemian.Cycle.Temp.Vostok, Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.I.Cycle.Temp.Vostok),#
SMA=c(Holocene.SMA.Vostok, Eemian.SMA.Vostok, Yarmouth.III.SMA.Vostok, Yarmouth.II.SMA.Vostok, Yarmouth.I.SMA.Vostok),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time.Vostok)), rep("Eemian", length(Eemian.Cycle.Time.Vostok)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time.Vostok)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time.Vostok)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time.Vostok)))#
)#
vostok.cycle.frame$Record <- rep("Vostok", length(vostok.cycle.frame[,1]))
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),
Yarmouth.I.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth I")
Yarmouth.I.Cycle.Age.Vostok
Yarmouth.I.Cycle.Time.Vostok <- subset(vostok$Cycle.Time.Vostok, vostok$Cycle=="Yarmouth I")
Yarmouth.I.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth I")
Yarmouth.I.Cycle.Time.Vostok <- subset(vostok$Cycle.Time.Vostok, vostok$Cycle=="Yarmouth I")
Yarmouth.I.Cycle.Time.Vostok
ls(vostok)
####Cycles#
Holocene.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Holocene")#
Holocene.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Holocene")#
Holocene.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle =="Holocene")#
Holocene.Data.Density.Vostok <- 1000/length(subset(Holocene.Cycle.Time.Vostok, Holocene.Cycle.Time.Vostok > 1 & Holocene.Cycle.Time.Vostok < 1000))#
Holocene.SMA.Val.Vostok <- 1000/Holocene.Data.Density.Vostok#
Holocene.SMA.Vostok <- SMA(Holocene.Cycle.Temp.Vostok, Holocene.SMA.Val.Vostok)#
#
Eemian.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Eemian")#
Eemian.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Eemian")#
Eemian.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Eemian")#
Eemian.Data.Density.Vostok <- 1000/length(subset(Eemian.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok > 1 & Eemian.Cycle.Time.Vostok < 1000))#
Eemian.SMA.Val.Vostok <- 1000/Eemian.Data.Density.Vostok#
Eemian.SMA.Vostok <- SMA(Eemian.Cycle.Temp.Vostok, Eemian.SMA.Val.Vostok)#
#
Yarmouth.III.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density.Vostok <- 1000/length(subset(Yarmouth.III.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok > 1 & Yarmouth.III.Cycle.Time.Vostok < 1000))#
Yarmouth.III.SMA.Val.Vostok <- 1000/Yarmouth.III.Data.Density.Vostok#
Yarmouth.III.SMA.Vostok <- SMA(Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.III.SMA.Val.Vostok)#
#
Yarmouth.II.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density.Vostok <- 1000/length(subset(Yarmouth.II.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok > 1 & Yarmouth.II.Cycle.Time.Vostok < 1000))#
Yarmouth.II.SMA.Val.Vostok <- 1000/Yarmouth.II.Data.Density.Vostok#
Yarmouth.II.SMA.Vostok <- SMA(Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.II.SMA.Val.Vostok)#
#
Yarmouth.I.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density.Vostok <- 1000/length(subset(Yarmouth.I.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok > 6952 & Yarmouth.I.Cycle.Time.Vostok < 7952))#
Yarmouth.I.SMA.Val.Vostok <- 1000/Yarmouth.I.Data.Density.Vostok#
Yarmouth.I.SMA.Vostok <- SMA(Yarmouth.I.Cycle.Temp.Vostok, Yarmouth.I.SMA.Val.Vostok)#
vostok.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),#
Time=c(Holocene.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok),#
Temp=c(Holocene.Cycle.Temp.Vostok, Eemian.Cycle.Temp.Vostok, Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.I.Cycle.Temp.Vostok),#
SMA=c(Holocene.SMA.Vostok, Eemian.SMA.Vostok, Yarmouth.III.SMA.Vostok, Yarmouth.II.SMA.Vostok, Yarmouth.I.SMA.Vostok),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time.Vostok)), rep("Eemian", length(Eemian.Cycle.Time.Vostok)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time.Vostok)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time.Vostok)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time.Vostok)))#
)#
vostok.cycle.frame$Record <- rep("Vostok", length(vostok.cycle.frame[,1]))
######All together#
#
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle", "Cycle.Time", "Record")])#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5.5), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
ls(epica)
Wisconsin.Cycle.Age <- subset(epica$Age, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Temp <- subset(epica$Temp, epica$Official =="Wisconsin")#
Wisconsin.Data.Density <- 1000/length(subset(Wisconsin.Cycle.Time, Wisconsin.Cycle.Time > 1 & Wisconsin.Cycle.Time < 1000))#
Wisconsin.SMA.Val <- 1000/Wisconsin.Data.Density#
Wisconsin.SMA <- SMA(Wisconsin.Cycle.Temp, Wisconsin.SMA.Val)
Wisconsin.SMA
Wisconsin.Cycle.Age <- subset(epica$Age, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Temp <- subset(epica$Temp, epica$Official =="Wisconsin")#
Wisconsin.Data.Density <- 1000/length(subset(Wisconsin.Cycle.Time, Wisconsin.Cycle.Time > 1 & Wisconsin.Cycle.Time < 1000))#
Wisconsin.SMA.Val <- 1000/Wisconsin.Data.Density#
Wisconsin.SMA <- SMA(Wisconsin.Cycle.Temp, Wisconsin.SMA.Val)#
#
Illinois.Cycle.Age <- subset(epica$Age, epica$Official=="Illinois")#
Illinois.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Illinois")#
Illinois.Cycle.Temp <- subset(epica$Temp, epica$Official=="Illinois")#
Illinois.Data.Density <- 1000/length(subset(Illinois.Cycle.Time, Illinois.Cycle.Time > 1 & Illinois.Cycle.Time < 1000))#
Illinois.SMA.Val <- 1000/Illinois.Data.Density#
Illinois.SMA <- SMA(Illinois.Cycle.Temp, Illinois.SMA.Val)#
#
Kansan.IV.Cycle.Age <- subset(epica$Age, epica$Cycle=="Kansan IV")#
Kansan.IV.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Kansan IV")#
Kansan.IV.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Kansan IV")#
Kansan.IV.Data.Density <- 1000/length(subset(Kansan.IV.Cycle.Time, Kansan.IV.Cycle.Time > 1 & Kansan.IV.Cycle.Time < 1000))#
Kansan.IV.SMA.Val <- 1000/Kansan.IV.Data.Density#
Kansan.IV.SMA <- SMA(Kansan.IV.Cycle.Temp, Kansan.IV.SMA.Val)#
#
Kansan.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Kansan III")#
Kansan.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Kansan III")#
Kansan.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Kansan III")#
Kansan.III.Data.Density <- 1000/length(subset(Kansan.III.Cycle.Time, Kansan.III.Cycle.Time > 1 & Kansan.III.Cycle.Time < 1000))#
Kansan.III.SMA.Val <- 1000/Kansan.III.Data.Density#
Kansan.III.SMA <- SMA(Kansan.III.Cycle.Temp, Kansan.III.SMA.Val)#
#
epica.glacial,cycle.frame <- data.frame(#
Age=c(Wisconsin.Cycle.Age, Illinois.Cycle.Age, Kansan.IV.Cycle.Age, Kansan.III.Cycle.Age),#
Time=c(Wisconsin.Cycle.Time, Illinois.Cycle.Time, Kansan.IV.Cycle.Time, Kansan.III.Cycle.Time),#
Temp=c(Wisconsin.Cycle.Temp, Illinois.Cycle.Temp, Kansan.IV.Cycle.Temp, Kansan.III.Cycle.Temp),#
SMA=c(Wisconsin.SMA, Illinois.SMA, Kansan.IV.SMA, Kansan.III.SMA),#
Period=c(rep("Wisconsin", length(Wisconsin.Cycle.Time)), rep("Illinois", length(Illinois.Cycle.Time)), rep("Kansan IV III", length(Kansan.IV.Cycle.Time)), rep("Kansan III", length(Kansan.III.Cycle.Time)))#
)#
epica.glacial$Record <- rep("EPICA", length(epica.glacial[,1]))
####Glacial Cycles#
#
Wisconsin.Cycle.Age <- subset(epica$Age, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Temp <- subset(epica$Temp, epica$Official =="Wisconsin")#
Wisconsin.Data.Density <- 1000/length(subset(Wisconsin.Cycle.Time, Wisconsin.Cycle.Time > 1 & Wisconsin.Cycle.Time < 1000))#
Wisconsin.SMA.Val <- 1000/Wisconsin.Data.Density#
Wisconsin.SMA <- SMA(Wisconsin.Cycle.Temp, Wisconsin.SMA.Val)#
#
Illinois.Cycle.Age <- subset(epica$Age, epica$Official=="Illinois")#
Illinois.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Illinois")#
Illinois.Cycle.Temp <- subset(epica$Temp, epica$Official=="Illinois")#
Illinois.Data.Density <- 1000/length(subset(Illinois.Cycle.Time, Illinois.Cycle.Time > 1 & Illinois.Cycle.Time < 1000))#
Illinois.SMA.Val <- 1000/Illinois.Data.Density#
Illinois.SMA <- SMA(Illinois.Cycle.Temp, Illinois.SMA.Val)#
#
Kansan.IV.Cycle.Age <- subset(epica$Age, epica$Cycle=="Kansan IV")#
Kansan.IV.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Kansan IV")#
Kansan.IV.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Kansan IV")#
Kansan.IV.Data.Density <- 1000/length(subset(Kansan.IV.Cycle.Time, Kansan.IV.Cycle.Time > 1 & Kansan.IV.Cycle.Time < 1000))#
Kansan.IV.SMA.Val <- 1000/Kansan.IV.Data.Density#
Kansan.IV.SMA <- SMA(Kansan.IV.Cycle.Temp, Kansan.IV.SMA.Val)#
#
Kansan.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Kansan III")#
Kansan.III.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Kansan III")#
Kansan.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Kansan III")#
Kansan.III.Data.Density <- 1000/length(subset(Kansan.III.Cycle.Time, Kansan.III.Cycle.Time > 1 & Kansan.III.Cycle.Time < 1000))#
Kansan.III.SMA.Val <- 1000/Kansan.III.Data.Density#
Kansan.III.SMA <- SMA(Kansan.III.Cycle.Temp, Kansan.III.SMA.Val)#
#
epica.glacial,cycle.frame <- data.frame(#
Age=c(Wisconsin.Cycle.Age, Illinois.Cycle.Age, Kansan.IV.Cycle.Age, Kansan.III.Cycle.Age),#
Time=c(Wisconsin.Cycle.Time, Illinois.Cycle.Time, Kansan.IV.Cycle.Time, Kansan.III.Cycle.Time),#
Temp=c(Wisconsin.Cycle.Temp, Illinois.Cycle.Temp, Kansan.IV.Cycle.Temp, Kansan.III.Cycle.Temp),#
SMA=c(Wisconsin.SMA, Illinois.SMA, Kansan.IV.SMA, Kansan.III.SMA),#
Period=c(rep("Wisconsin", length(Wisconsin.Cycle.Time)), rep("Illinois", length(Illinois.Cycle.Time)), rep("Kansan IV III", length(Kansan.IV.Cycle.Time)), rep("Kansan III", length(Kansan.III.Cycle.Time)))#
)#
epica.glacial$Record <- rep("EPICA", length(epica.glacial[,1]))
####Glacial Cycles#
#
Wisconsin.Cycle.Age <- subset(epica$Age, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Temp <- subset(epica$Temp, epica$Official =="Wisconsin")#
Wisconsin.Data.Density <- 1000/length(subset(Wisconsin.Cycle.Time, Wisconsin.Cycle.Time > 1 & Wisconsin.Cycle.Time < 1000))#
Wisconsin.SMA.Val <- 1000/Wisconsin.Data.Density#
Wisconsin.SMA <- SMA(Wisconsin.Cycle.Temp, Wisconsin.SMA.Val)#
#
Illinois.Cycle.Age <- subset(epica$Age, epica$Official=="Illinois")#
Illinois.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Illinois")#
Illinois.Cycle.Temp <- subset(epica$Temp, epica$Official=="Illinois")#
Illinois.Data.Density <- 1000/length(subset(Illinois.Cycle.Time, Illinois.Cycle.Time > 1 & Illinois.Cycle.Time < 1000))#
Illinois.SMA.Val <- 1000/Illinois.Data.Density#
Illinois.SMA <- SMA(Illinois.Cycle.Temp, Illinois.SMA.Val)#
#
Kansan.IV.Cycle.Age <- subset(epica$Age, epica$Official=="Kansan IV")#
Kansan.IV.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Kansan IV")#
Kansan.IV.Cycle.Temp <- subset(epica$Temp, epica$Official=="Kansan IV")#
Kansan.IV.Data.Density <- 1000/length(subset(Kansan.IV.Cycle.Time, Kansan.IV.Cycle.Time > 1 & Kansan.IV.Cycle.Time < 1000))#
Kansan.IV.SMA.Val <- 1000/Kansan.IV.Data.Density#
Kansan.IV.SMA <- SMA(Kansan.IV.Cycle.Temp, Kansan.IV.SMA.Val)#
#
Kansan.III.Cycle.Age <- subset(epica$Age, epica$Official=="Kansan III")#
Kansan.III.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Kansan III")#
Kansan.III.Cycle.Temp <- subset(epica$Temp, epica$Official=="Kansan III")#
Kansan.III.Data.Density <- 1000/length(subset(Kansan.III.Cycle.Time, Kansan.III.Cycle.Time > 1 & Kansan.III.Cycle.Time < 1000))#
Kansan.III.SMA.Val <- 1000/Kansan.III.Data.Density#
Kansan.III.SMA <- SMA(Kansan.III.Cycle.Temp, Kansan.III.SMA.Val)#
#
epica.glacial,cycle.frame <- data.frame(#
Age=c(Wisconsin.Cycle.Age, Illinois.Cycle.Age, Kansan.IV.Cycle.Age, Kansan.III.Cycle.Age),#
Time=c(Wisconsin.Cycle.Time, Illinois.Cycle.Time, Kansan.IV.Cycle.Time, Kansan.III.Cycle.Time),#
Temp=c(Wisconsin.Cycle.Temp, Illinois.Cycle.Temp, Kansan.IV.Cycle.Temp, Kansan.III.Cycle.Temp),#
SMA=c(Wisconsin.SMA, Illinois.SMA, Kansan.IV.SMA, Kansan.III.SMA),#
Period=c(rep("Wisconsin", length(Wisconsin.Cycle.Time)), rep("Illinois", length(Illinois.Cycle.Time)), rep("Kansan IV III", length(Kansan.IV.Cycle.Time)), rep("Kansan III", length(Kansan.III.Cycle.Time)))#
)#
epica.glacial$Record <- rep("EPICA", length(epica.glacial[,1]))
epica.glacial,cycle.frame <- data.frame(#
Age=c(Wisconsin.Cycle.Age, Illinois.Cycle.Age, Kansan.IV.Cycle.Age, Kansan.III.Cycle.Age),#
Time=c(Wisconsin.Cycle.Time, Illinois.Cycle.Time, Kansan.IV.Cycle.Time, Kansan.III.Cycle.Time),#
Temp=c(Wisconsin.Cycle.Temp, Illinois.Cycle.Temp, Kansan.IV.Cycle.Temp, Kansan.III.Cycle.Temp),#
SMA=c(Wisconsin.SMA, Illinois.SMA, Kansan.IV.SMA, Kansan.III.SMA),#
Period=c(rep("Wisconsin", length(Wisconsin.Cycle.Time)), rep("Illinois", length(Illinois.Cycle.Time)), rep("Kansan IV", length(Kansan.IV.Cycle.Time)), rep("Kansan III", length(Kansan.III.Cycle.Time)))#
)#
epica.glacial$Record <- rep("EPICA", length(epica.glacial[,1]))
epica.glacial.cycle.frame <- data.frame(#
Age=c(Wisconsin.Cycle.Age, Illinois.Cycle.Age, Kansan.IV.Cycle.Age, Kansan.III.Cycle.Age),#
Time=c(Wisconsin.Cycle.Time, Illinois.Cycle.Time, Kansan.IV.Cycle.Time, Kansan.III.Cycle.Time),#
Temp=c(Wisconsin.Cycle.Temp, Illinois.Cycle.Temp, Kansan.IV.Cycle.Temp, Kansan.III.Cycle.Temp),#
SMA=c(Wisconsin.SMA, Illinois.SMA, Kansan.IV.SMA, Kansan.III.SMA),#
Period=c(rep("Wisconsin", length(Wisconsin.Cycle.Time)), rep("Illinois", length(Illinois.Cycle.Time)), rep("Kansan IV", length(Kansan.IV.Cycle.Time)), rep("Kansan III", length(Kansan.III.Cycle.Time)))#
)#
epica.glacial.cycle.frame$Record <- rep("EPICA", length(epica.glacial.cycle.frame[,1]))
ls(vostok)
####Glacial Cycles#
#
Wisconsin.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Official.Name=="Wisconsin")#
Wisconsin.Cycle.Time.Vostok <- subset(vostok$Time.Since.Change, vostok$Official.Name=="Wisconsin")#
Wisconsin.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Official.Name =="Wisconsin")#
Wisconsin.Data.Density.Vostok <- 1000/length(subset(Wisconsin.Cycle.Time.Vostok, Wisconsin.Cycle.Time.Vostok > 1 & Wisconsin.Cycle.Time.Vostok < 1000))#
Wisconsin.SMA.Val.Vostok <- 1000/Wisconsin.Data.Density.Vostok#
Wisconsin.SMA.Vostok <- SMA(Wisconsin.Cycle.Temp.Vostok, Wisconsin.SMA.Val.Vostok)#
#
Illinois.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Official.Name=="Illinois")#
Illinois.Cycle.Time.Vostok <- subset(vostok$Time.Since.Change, vostok$Official.Name=="Illinois")#
Illinois.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Official.Name=="Illinois")#
Illinois.Data.Density.Vostok <- 1000/length(subset(Illinois.Cycle.Time.Vostok, Illinois.Cycle.Time.Vostok > 1 & Illinois.Cycle.Time.Vostok < 1000))#
Illinois.SMA.Val.Vostok <- 1000/Illinois.Data.Density.Vostok#
Illinois.SMA.Vostok <- SMA(Illinois.Cycle.Temp.Vostok, Illinois.SMA.Val.Vostok)#
#
Kansan.IV.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Official.Name=="Kansan IV")#
Kansan.IV.Cycle.Time.Vostok <- subset(vostok$Time.Since.Change, vostok$Official.Name=="Kansan IV")#
Kansan.IV.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Official.Name=="Kansan IV")#
Kansan.IV.Data.Density.Vostok <- 1000/length(subset(Kansan.IV.Cycle.Time.Vostok, Kansan.IV.Cycle.Time.Vostok > 1 & Kansan.IV.Cycle.Time.Vostok < 1000))#
Kansan.IV.SMA.Val.Vostok <- 1000/Kansan.IV.Data.Density.Vostok#
Kansan.IV.SMA.Vostok <- SMA(Kansan.IV.Cycle.Temp, Kansan.IV.SMA.Val.Vostok)#
#
Kansan.III.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Official.Name=="Kansan III")#
Kansan.III.Cycle.Time.Vostok <- subset(vostok$Time.Since.Change, vostok$Official.Name=="Kansan III")#
Kansan.III.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Official.Name=="Kansan III")#
Kansan.III.Data.Density.Vostok <- 1000/length(subset(Kansan.III.Cycle.Time.Vostok, Kansan.III.Cycle.Time.Vostok > 1 & Kansan.III.Cycle.Time.Vostok < 1000))#
Kansan.III.SMA.Val.Vostok <- 1000/Kansan.III.Data.Density.Vostok#
Kansan.III.SMA.Vostok <- SMA(Kansan.III.Cycle.Temp.Vostok, Kansan.III.SMA.Val.Vostok)#
#
vostok.glacial.cycle.frame <- data.frame(#
Age=c(Wisconsin.Cycle.Age.Vostok, Illinois.Cycle.Age.Vostok, Kansan.IV.Cycle.Age.Vostok, Kansan.III.Cycle.Age.Vostok),#
Time=c(Wisconsin.Cycle.Time.Vostok, Illinois.Cycle.Time.Vostok, Kansan.IV.Cycle.Time.Vostok, Kansan.III.Cycle.Time.Vostok),#
Temp=c(Wisconsin.Cycle.Temp.Vostok, Illinois.Cycle.Temp.Vostok, Kansan.IV.Cycle.Temp.Vostok, Kansan.III.Cycle.Temp.Vostok),#
SMA=c(Wisconsin.SMA.Vostok, Illinois.SMA.Vostok, Kansan.IV.SMA.Vostok, Kansan.III.SMA.Vostok),#
Period=c(rep("Wisconsin", length(Wisconsin.Cycle.Time.Vostok)), rep("Illinois", length(Illinois.Cycle.Time.Vostok)), rep("Kansan IV", length(Kansan.IV.Cycle.Time.Vostok)), rep("Kansan III", length(Kansan.III.Cycle.Time.Vostok)))#
)#
vostok.glacial.cycle.frame$Record <- rep("Vostok", length(vostok.glacial.cycle.frame[,1]))
length(c(Wisconsin.Cycle.Age.Vostok, Illinois.Cycle.Age.Vostok, Kansan.IV.Cycle.Age.Vostok, Kansan.III.Cycle.Age.Vostok))
length(c(Wisconsin.Cycle.Time.Vostok, Illinois.Cycle.Time.Vostok, Kansan.IV.Cycle.Time.Vostok, Kansan.III.Cycle.Time.Vostok))
length(c(Wisconsin.Cycle.Temp.Vostok, Illinois.Cycle.Temp.Vostok, Kansan.IV.Cycle.Temp.Vostok, Kansan.III.Cycle.Temp.Vostok))
length(c(Wisconsin.SMA.Vostok, Illinois.SMA.Vostok, Kansan.IV.SMA.Vostok, Kansan.III.SMA.Vostok))
Kansan.IV.SMA.Vostok <- SMA(Kansan.IV.Cycle.Temp.Vostok, Kansan.IV.SMA.Val.Vostok)
vostok.glacial.cycle.frame <- data.frame(#
Age=c(Wisconsin.Cycle.Age.Vostok, Illinois.Cycle.Age.Vostok, Kansan.IV.Cycle.Age.Vostok, Kansan.III.Cycle.Age.Vostok),#
Time=c(Wisconsin.Cycle.Time.Vostok, Illinois.Cycle.Time.Vostok, Kansan.IV.Cycle.Time.Vostok, Kansan.III.Cycle.Time.Vostok),#
Temp=c(Wisconsin.Cycle.Temp.Vostok, Illinois.Cycle.Temp.Vostok, Kansan.IV.Cycle.Temp.Vostok, Kansan.III.Cycle.Temp.Vostok),#
SMA=c(Wisconsin.SMA.Vostok, Illinois.SMA.Vostok, Kansan.IV.SMA.Vostok, Kansan.III.SMA.Vostok),#
Period=c(rep("Wisconsin", length(Wisconsin.Cycle.Time.Vostok)), rep("Illinois", length(Illinois.Cycle.Time.Vostok)), rep("Kansan IV", length(Kansan.IV.Cycle.Time.Vostok)), rep("Kansan III", length(Kansan.III.Cycle.Time.Vostok)))#
)#
vostok.glacial.cycle.frame$Record <- rep("Vostok", length(vostok.glacial.cycle.frame[,1]))
all.data.glacial.cycle <- rbind(epica.glacial.cycle.frame, vostok.glacial.cycle.frame)
###Comparative Glacial Plot#
glacial.plot.all <- ggplot(all.data.glacial.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 30000), breaks = seq(0, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/GlacialCompare.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Comparative Glacial Plot#
glacial.plot.all <- ggplot(all.data.glacial.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 30000), breaks = seq(0, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/GlacialCompare.tiff", glacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "solid", "blank","blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5.5), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "solid", "blank","blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5.5), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", wisconsin.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "blank", "blank","solid") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5.5), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", wisconsin.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "blank", "blank","solid") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-15, -5), breaks=seq(-15, -5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", wisconsin.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "blank", "blank", "solid") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 0), breaks=seq(-10, 0, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", wisconsin.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "blank", "blank", "solid") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-15, 0), breaks=seq(-15, 0, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", wisconsin.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "blank", "blank", "solid") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-15, 2), breaks=seq(-15, 2, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", wisconsin.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "blank", "blank", "solid") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-15, 10), breaks=seq(-15, 10, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", wisconsin.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "blank", "blank", "solid") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-20, 3), breaks=seq(-20, 3, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", wisconsin.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "blank", "blank", "solid") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-20, 5), breaks=seq(-20, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", wisconsin.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Wisconsin Variation Plot#
wisconsin.plot.all <- ggplot(all.data.glacial.cycle) +#
stat_smooth(data=subset(all.data.glacial.cycle, all.data.glacial.cycle$Period!="Wisconsin"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Wisconsin", "Illinois", "Kansas IV", "Kansas III"),#
values=c("blank", "blank", "blank", "solid") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-20, 7), breaks=seq(-20, 7, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/WisconsinCompare.tiff", wisconsin.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
update.packages()
#Erase everything that comes before#
rm(list = ls(all = TRUE))#
#
#packrat::init("~/Dropbox/4.2 ky event/Data Analysis/R Code/For Distribution/Neolithic")#
#
#Compatibility#
if(.Platform$OS.type=="windows") {#
  quartz<-function() windows()#
}#
#
###Load Packages#
library(TTR)#
library(ggplot2)#
library(gridExtra)#
library(scales)#
library(gtable)#
library(wq)#
library(Bchron)#
library(plyr)#
library(bcp)#
#library(mgcv)#
library(reshape)#
library(pbapply)#
library(Cairo)#
####Function to organize plots in a window#
layOut = function(...) {#
    require(grid)#
    x <- list(...)#
    n <- max(sapply(x, function(x) max(x[[2]])))#
    p <- max(sapply(x, function(x) max(x[[3]])))#
    pushViewport(viewport(layout = grid.layout(n, p)))#
    for (i in seq_len(length(x))) {#
        print(x[[i]][[1]], vp = viewport(layout.pos.row = x[[i]][[2]],#
        layout.pos.col = x[[i]][[3]]))#
    }#
}#
###Load Data#
megafauna.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Megafauna Database/Megafauna Sigma Purge-Table 1.csv")#
human.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Humans Audited.csv")#
gisp2 <- read.csv(file="~/Dropbox/Documents/SCDPD/gisp2.csv")#
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")#
vostok <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/vostok.csv")#
###Load Calibration Curves#
intcal.13 <- read.csv(file="~/Dropbox/Documents/Peru/intcal13.csv")#
#
###Create vectors from data set by region#
#####
Transition.A.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition A")#
Transition.A.Temp <- subset(epica$Temp, epica$Stage=="Transition A")#
#
Transition.B.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition B")#
Transition.B.Temp <- subset(epica$Temp, epica$Stage=="Transition B")#
#
Transition.C.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition C")#
Transition.C.Temp <- subset(epica$Temp, epica$Stage=="Transition C")#
#
Transition.D.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition D")#
Transition.D.Temp <- subset(epica$Temp, epica$Stage=="Transition D")#
#
Transition.E.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition E")#
Transition.E.Temp <- subset(epica$Temp, epica$Stage=="Transition E")#
#
Transition.Z.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition Z")#
Transition.Z.Temp <- subset(epica$Temp, epica$Stage=="Transition Z")#
#
Transition.Y.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition Y")#
Transition.Y.Temp <- subset(epica$Temp, epica$Stage=="Transition Y")#
#
Transition.X.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition X")#
Transition.X.Temp <- subset(epica$Temp, epica$Stage=="Transition X")#
#
Transition.W.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition W")#
Transition.W.Temp <- subset(epica$Temp, epica$Stage=="Transition W")#
#
Glacial.A.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial A")#
Glacial.A.Temp <- subset(epica$Temp, epica$Stage=="Glacial A")#
#
Glacial.B.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial B")#
Glacial.B.Temp <- subset(epica$Temp, epica$Stage=="Glacial B")#
#
Glacial.C.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial C")#
Glacial.C.Temp <- subset(epica$Temp, epica$Stage=="Glacial C")#
#
Glacial.D.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial D")#
Glacial.D.Temp <- subset(epica$Temp, epica$Stage=="Glacial D")#
#
Glacial.E.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial E")#
Glacial.E.Temp <- subset(epica$Temp, epica$Stage=="Glacial E")#
#
Interglacial.A.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial A")#
Interglacial.A.Temp <- subset(epica$Temp, epica$Stage=="Interglacial A")#
#
Interglacial.B.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial B")#
Interglacial.B.Temp <- subset(epica$Temp, epica$Stage=="Interglacial B")#
#
Interglacial.C.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial C")#
Interglacial.C.Temp <- subset(epica$Temp, epica$Stage=="Interglacial C")#
#
Interglacial.D.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial D")#
Interglacial.D.Temp <- subset(epica$Temp, epica$Stage=="Interglacial D")#
#
Interglacial.E.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial E")#
Interglacial.E.Temp <- subset(epica$Temp, epica$Stage=="Interglacial E")#
####United Plot#
Holocene.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Holocene")#
Holocene.Temp <- subset(epica$Temp, epica$Broad.Time.Period =="Holocene")#
#
Wisconsin.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Wisconsin")#
Wisconsin.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Wisconsin")#
#
Eemian.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Eemian")#
Eemian.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Eemian")#
#
Illinois.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Illinois")#
Illinois.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Illinois")#
#
Yarmouth.III.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Yarmouth III")#
Yarmouth.III.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Yarmouth III")#
#
Kansan.IV.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Kansan IV")#
Kansan.IV.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Kansan IV")#
#
Yarmouth.II.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Yarmouth II")#
Yarmouth.II.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Yarmouth II")#
#
Kansan.III.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Kansan III")#
Kansan.III.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Kansan III")#
#
Yarmouth.I.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Yarmouth I")#
Yarmouth.I.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Yarmouth I")#
#
Extinction.Time <- subset(epica$Broad.Time.Since.Change, epica$Extinction=="Pleistocene Extinction")#
Extinction.Temp <- subset(epica$Temp, epica$Extinction=="Pleistocene Extinction")#
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time)))#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
####VOSTOK#
####Cycles#
Holocene.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Holocene")#
Holocene.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Holocene")#
Holocene.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle =="Holocene")#
Holocene.Data.Density.Vostok <- 1000/length(subset(Holocene.Cycle.Time.Vostok, Holocene.Cycle.Time.Vostok > 1 & Holocene.Cycle.Time.Vostok < 1000))#
Holocene.SMA.Val.Vostok <- 1000/Holocene.Data.Density.Vostok#
Holocene.SMA.Vostok <- SMA(Holocene.Cycle.Temp.Vostok, Holocene.SMA.Val.Vostok)#
#
Eemian.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Eemian")#
Eemian.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Eemian")#
Eemian.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Eemian")#
Eemian.Data.Density.Vostok <- 1000/length(subset(Eemian.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok > 1 & Eemian.Cycle.Time.Vostok < 1000))#
Eemian.SMA.Val.Vostok <- 1000/Eemian.Data.Density.Vostok#
Eemian.SMA.Vostok <- SMA(Eemian.Cycle.Temp.Vostok, Eemian.SMA.Val.Vostok)#
#
Yarmouth.III.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density.Vostok <- 1000/length(subset(Yarmouth.III.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok > 1 & Yarmouth.III.Cycle.Time.Vostok < 1000))#
Yarmouth.III.SMA.Val.Vostok <- 1000/Yarmouth.III.Data.Density.Vostok#
Yarmouth.III.SMA.Vostok <- SMA(Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.III.SMA.Val.Vostok)#
#
Yarmouth.II.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density.Vostok <- 1000/length(subset(Yarmouth.II.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok > 1 & Yarmouth.II.Cycle.Time.Vostok < 1000))#
Yarmouth.II.SMA.Val.Vostok <- 1000/Yarmouth.II.Data.Density.Vostok#
Yarmouth.II.SMA.Vostok <- SMA(Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.II.SMA.Val.Vostok)#
#
Yarmouth.I.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density.Vostok <- 1000/length(subset(Yarmouth.I.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok > 6952 & Yarmouth.I.Cycle.Time.Vostok < 7952))#
Yarmouth.I.SMA.Val.Vostok <- 1000/Yarmouth.I.Data.Density.Vostok#
Yarmouth.I.SMA.Vostok <- SMA(Yarmouth.I.Cycle.Temp.Vostok, Yarmouth.I.SMA.Val.Vostok)#
vostok.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),#
Time=c(Holocene.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok),#
Temp=c(Holocene.Cycle.Temp.Vostok, Eemian.Cycle.Temp.Vostok, Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.I.Cycle.Temp.Vostok),#
SMA=c(Holocene.SMA.Vostok, Eemian.SMA.Vostok, Yarmouth.III.SMA.Vostok, Yarmouth.II.SMA.Vostok, Yarmouth.I.SMA.Vostok),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time.Vostok)), rep("Eemian", length(Eemian.Cycle.Time.Vostok)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time.Vostok)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time.Vostok)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time.Vostok)))#
)#
vostok.cycle.frame$Record <- rep("Vostok", length(vostok.cycle.frame[,1]))
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle", "Cycle.Time", "Record")])#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 30000), breaks = seq(0, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
interglacial.plot.all
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
interglacial.plot.all
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5.5), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5.5), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-11, 5.5), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.01, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-11, 5.5), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.01, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-11, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.01, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years preceeding temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years preceeding temperature increase", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
ls(all.data.cycle)
head(all.data.cycle)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(Age, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years preceeding temperature increase", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(Age, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("Years preceeding temperature increase", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(Time, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(Age, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("Years since preceeding Glacial", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("Years preceeding temperature increase", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
?scale_x_continuous
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Age-16401, Eemian.Cycle.Age-16401, Yarmouth.III.Cycle.Age--16401, Yarmouth.II.Cycle.Age-16401, Yarmouth.I.Cycle.Age-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
vostok.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),#
Time=c(Holocene.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok),#
Temp=c(Holocene.Cycle.Temp.Vostok, Eemian.Cycle.Temp.Vostok, Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.I.Cycle.Temp.Vostok),#
SMA=c(Holocene.SMA.Vostok, Eemian.SMA.Vostok, Yarmouth.III.SMA.Vostok, Yarmouth.II.SMA.Vostok, Yarmouth.I.SMA.Vostok),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time.Vostok)), rep("Eemian", length(Eemian.Cycle.Time.Vostok)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time.Vostok)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time.Vostok)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time.Vostok))),#
ModAge=c(Holocene.Cycle.Age.Vostok-16889, Eemian.Cycle.Age.Vostok-16889, Yarmouth.III.Cycle.Age.Vostok-16889, Yarmouth.II.Cycle.Age.Vostok-16889, Yarmouth.I.Cycle.Age.Vostok-16889)#
#
)#
vostok.cycle.frame$Record <- rep("Vostok", length(vostok.cycle.frame[,1]))
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
ls(all.data.cycle)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years preceeding temperature increase", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("Cal yr BP", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("Cal yr BP", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years preceeding temperature increase", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
Yarmouth.I.Cycle.Age-16401
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time--16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
vostok.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),#
Time=c(Holocene.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok),#
Temp=c(Holocene.Cycle.Temp.Vostok, Eemian.Cycle.Temp.Vostok, Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.I.Cycle.Temp.Vostok),#
SMA=c(Holocene.SMA.Vostok, Eemian.SMA.Vostok, Yarmouth.III.SMA.Vostok, Yarmouth.II.SMA.Vostok, Yarmouth.I.SMA.Vostok),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time.Vostok)), rep("Eemian", length(Eemian.Cycle.Time.Vostok)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time.Vostok)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time.Vostok)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time.Vostok))),#
ModAge=c(Holocene.Cycle.Time.Vostok-16889, Eemian.Cycle.Time.Vostok-16889, Yarmouth.III.Cycle.Time.Vostok-16889, Yarmouth.II.Cycle.Time.Vostok-16889, Yarmouth.I.Cycle.Time.Vostok-16889)#
#
)#
vostok.cycle.frame$Record <- rep("Vostok", length(vostok.cycle.frame[,1]))
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years preceeding temperature increase", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years preceeding temperature increase", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_y_reverse("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("Years since preceeding Glacial", labels=comma, limits = c(-10000, 20000), breaks = seq(-10000, 20000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("Years preceeding temperature increase", labels=comma, limits = c(0, 20000), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(0, 20000), breaks = seq(20000, 0, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(20000, 0), breaks = seq(0, 20000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("cal yr BP", labels=comma, limits = c(0, 25000), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("cal yr BP", labels=comma, limits = c(0, 25000), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
head(all.data.cycle)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("cal yr BP", labels=comma, limits = c(-25000, 0), breaks = seq(-25000, 0, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.03, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.01, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, -5000), breaks = seq(-5000, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
#Erase everything that comes before#
rm(list = ls(all = TRUE))#
#
#packrat::init("~/Dropbox/4.2 ky event/Data Analysis/R Code/For Distribution/Neolithic")#
#
#Compatibility#
if(.Platform$OS.type=="windows") {#
  quartz<-function() windows()#
}#
#
###Load Packages#
library(TTR)#
library(ggplot2)#
library(gridExtra)#
library(scales)#
library(gtable)#
library(wq)#
library(Bchron)#
library(plyr)#
library(bcp)#
#library(mgcv)#
library(reshape)#
library(pbapply)#
library(Cairo)#
####Function to organize plots in a window#
layOut = function(...) {#
    require(grid)#
    x <- list(...)#
    n <- max(sapply(x, function(x) max(x[[2]])))#
    p <- max(sapply(x, function(x) max(x[[3]])))#
    pushViewport(viewport(layout = grid.layout(n, p)))#
    for (i in seq_len(length(x))) {#
        print(x[[i]][[1]], vp = viewport(layout.pos.row = x[[i]][[2]],#
        layout.pos.col = x[[i]][[3]]))#
    }#
}#
###Load Data#
megafauna.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Megafauna Database/Megafauna Sigma Purge-Table 1.csv")#
human.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Humans Audited.csv")#
gisp2 <- read.csv(file="~/Dropbox/Documents/SCDPD/gisp2.csv")#
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")#
vostok <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/vostok.csv")#
###Load Calibration Curves#
intcal.13 <- read.csv(file="~/Dropbox/Documents/Peru/intcal13.csv")#
#
###Create vectors from data set by region#
#####
Transition.A.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition A")#
Transition.A.Temp <- subset(epica$Temp, epica$Stage=="Transition A")#
#
Transition.B.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition B")#
Transition.B.Temp <- subset(epica$Temp, epica$Stage=="Transition B")#
#
Transition.C.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition C")#
Transition.C.Temp <- subset(epica$Temp, epica$Stage=="Transition C")#
#
Transition.D.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition D")#
Transition.D.Temp <- subset(epica$Temp, epica$Stage=="Transition D")#
#
Transition.E.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition E")#
Transition.E.Temp <- subset(epica$Temp, epica$Stage=="Transition E")#
#
Transition.Z.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition Z")#
Transition.Z.Temp <- subset(epica$Temp, epica$Stage=="Transition Z")#
#
Transition.Y.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition Y")#
Transition.Y.Temp <- subset(epica$Temp, epica$Stage=="Transition Y")#
#
Transition.X.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition X")#
Transition.X.Temp <- subset(epica$Temp, epica$Stage=="Transition X")#
#
Transition.W.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition W")#
Transition.W.Temp <- subset(epica$Temp, epica$Stage=="Transition W")#
#
Glacial.A.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial A")#
Glacial.A.Temp <- subset(epica$Temp, epica$Stage=="Glacial A")#
#
Glacial.B.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial B")#
Glacial.B.Temp <- subset(epica$Temp, epica$Stage=="Glacial B")#
#
Glacial.C.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial C")#
Glacial.C.Temp <- subset(epica$Temp, epica$Stage=="Glacial C")#
#
Glacial.D.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial D")#
Glacial.D.Temp <- subset(epica$Temp, epica$Stage=="Glacial D")#
#
Glacial.E.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial E")#
Glacial.E.Temp <- subset(epica$Temp, epica$Stage=="Glacial E")#
#
Interglacial.A.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial A")#
Interglacial.A.Temp <- subset(epica$Temp, epica$Stage=="Interglacial A")#
#
Interglacial.B.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial B")#
Interglacial.B.Temp <- subset(epica$Temp, epica$Stage=="Interglacial B")#
#
Interglacial.C.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial C")#
Interglacial.C.Temp <- subset(epica$Temp, epica$Stage=="Interglacial C")#
#
Interglacial.D.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial D")#
Interglacial.D.Temp <- subset(epica$Temp, epica$Stage=="Interglacial D")#
#
Interglacial.E.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial E")#
Interglacial.E.Temp <- subset(epica$Temp, epica$Stage=="Interglacial E")#
####United Plot#
Holocene.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Holocene")#
Holocene.Temp <- subset(epica$Temp, epica$Broad.Time.Period =="Holocene")#
#
Wisconsin.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Wisconsin")#
Wisconsin.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Wisconsin")#
#
Eemian.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Eemian")#
Eemian.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Eemian")#
#
Illinois.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Illinois")#
Illinois.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Illinois")#
#
Yarmouth.III.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Yarmouth III")#
Yarmouth.III.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Yarmouth III")#
#
Kansan.IV.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Kansan IV")#
Kansan.IV.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Kansan IV")#
#
Yarmouth.II.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Yarmouth II")#
Yarmouth.II.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Yarmouth II")#
#
Kansan.III.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Kansan III")#
Kansan.III.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Kansan III")#
#
Yarmouth.I.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Yarmouth I")#
Yarmouth.I.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Yarmouth I")#
#
Extinction.Time <- subset(epica$Broad.Time.Since.Change, epica$Extinction=="Pleistocene Extinction")#
Extinction.Temp <- subset(epica$Temp, epica$Extinction=="Pleistocene Extinction")#
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))#
####Glacial Cycles#
#
Wisconsin.Cycle.Age <- subset(epica$Age, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Temp <- subset(epica$Temp, epica$Official =="Wisconsin")#
Wisconsin.Data.Density <- 1000/length(subset(Wisconsin.Cycle.Time, Wisconsin.Cycle.Time > 1 & Wisconsin.Cycle.Time < 1000))#
Wisconsin.SMA.Val <- 1000/Wisconsin.Data.Density#
Wisconsin.SMA <- SMA(Wisconsin.Cycle.Temp, Wisconsin.SMA.Val)#
#
Illinois.Cycle.Age <- subset(epica$Age, epica$Official=="Illinois")#
Illinois.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Illinois")#
Illinois.Cycle.Temp <- subset(epica$Temp, epica$Official=="Illinois")#
Illinois.Data.Density <- 1000/length(subset(Illinois.Cycle.Time, Illinois.Cycle.Time > 1 & Illinois.Cycle.Time < 1000))#
Illinois.SMA.Val <- 1000/Illinois.Data.Density#
Illinois.SMA <- SMA(Illinois.Cycle.Temp, Illinois.SMA.Val)#
#
Kansan.IV.Cycle.Age <- subset(epica$Age, epica$Official=="Kansan IV")#
Kansan.IV.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Kansan IV")#
Kansan.IV.Cycle.Temp <- subset(epica$Temp, epica$Official=="Kansan IV")#
Kansan.IV.Data.Density <- 1000/length(subset(Kansan.IV.Cycle.Time, Kansan.IV.Cycle.Time > 1 & Kansan.IV.Cycle.Time < 1000))#
Kansan.IV.SMA.Val <- 1000/Kansan.IV.Data.Density#
Kansan.IV.SMA <- SMA(Kansan.IV.Cycle.Temp, Kansan.IV.SMA.Val)#
#
Kansan.III.Cycle.Age <- subset(epica$Age, epica$Official=="Kansan III")#
Kansan.III.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Kansan III")#
Kansan.III.Cycle.Temp <- subset(epica$Temp, epica$Official=="Kansan III")#
Kansan.III.Data.Density <- 1000/length(subset(Kansan.III.Cycle.Time, Kansan.III.Cycle.Time > 1 & Kansan.III.Cycle.Time < 1000))#
Kansan.III.SMA.Val <- 1000/Kansan.III.Data.Density#
Kansan.III.SMA <- SMA(Kansan.III.Cycle.Temp, Kansan.III.SMA.Val)#
#
epica.glacial.cycle.frame <- data.frame(#
Age=c(Wisconsin.Cycle.Age, Illinois.Cycle.Age, Kansan.IV.Cycle.Age, Kansan.III.Cycle.Age),#
Time=c(Wisconsin.Cycle.Time, Illinois.Cycle.Time, Kansan.IV.Cycle.Time, Kansan.III.Cycle.Time),#
Temp=c(Wisconsin.Cycle.Temp, Illinois.Cycle.Temp, Kansan.IV.Cycle.Temp, Kansan.III.Cycle.Temp),#
SMA=c(Wisconsin.SMA, Illinois.SMA, Kansan.IV.SMA, Kansan.III.SMA),#
Period=c(rep("Wisconsin", length(Wisconsin.Cycle.Time)), rep("Illinois", length(Illinois.Cycle.Time)), rep("Kansan IV", length(Kansan.IV.Cycle.Time)), rep("Kansan III", length(Kansan.III.Cycle.Time)))#
)#
epica.glacial.cycle.frame$Record <- rep("EPICA", length(epica.glacial.cycle.frame[,1]))
####VOSTOK#
####Cycles#
Holocene.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Holocene")#
Holocene.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Holocene")#
Holocene.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle =="Holocene")#
Holocene.Data.Density.Vostok <- 1000/length(subset(Holocene.Cycle.Time.Vostok, Holocene.Cycle.Time.Vostok > 1 & Holocene.Cycle.Time.Vostok < 1000))#
Holocene.SMA.Val.Vostok <- 1000/Holocene.Data.Density.Vostok#
Holocene.SMA.Vostok <- SMA(Holocene.Cycle.Temp.Vostok, Holocene.SMA.Val.Vostok)#
#
Eemian.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Eemian")#
Eemian.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Eemian")#
Eemian.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Eemian")#
Eemian.Data.Density.Vostok <- 1000/length(subset(Eemian.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok > 1 & Eemian.Cycle.Time.Vostok < 1000))#
Eemian.SMA.Val.Vostok <- 1000/Eemian.Data.Density.Vostok#
Eemian.SMA.Vostok <- SMA(Eemian.Cycle.Temp.Vostok, Eemian.SMA.Val.Vostok)#
#
Yarmouth.III.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density.Vostok <- 1000/length(subset(Yarmouth.III.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok > 1 & Yarmouth.III.Cycle.Time.Vostok < 1000))#
Yarmouth.III.SMA.Val.Vostok <- 1000/Yarmouth.III.Data.Density.Vostok#
Yarmouth.III.SMA.Vostok <- SMA(Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.III.SMA.Val.Vostok)#
#
Yarmouth.II.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density.Vostok <- 1000/length(subset(Yarmouth.II.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok > 1 & Yarmouth.II.Cycle.Time.Vostok < 1000))#
Yarmouth.II.SMA.Val.Vostok <- 1000/Yarmouth.II.Data.Density.Vostok#
Yarmouth.II.SMA.Vostok <- SMA(Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.II.SMA.Val.Vostok)#
#
Yarmouth.I.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density.Vostok <- 1000/length(subset(Yarmouth.I.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok > 6952 & Yarmouth.I.Cycle.Time.Vostok < 7952))#
Yarmouth.I.SMA.Val.Vostok <- 1000/Yarmouth.I.Data.Density.Vostok#
Yarmouth.I.SMA.Vostok <- SMA(Yarmouth.I.Cycle.Temp.Vostok, Yarmouth.I.SMA.Val.Vostok)#
vostok.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),#
Time=c(Holocene.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok),#
Temp=c(Holocene.Cycle.Temp.Vostok, Eemian.Cycle.Temp.Vostok, Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.I.Cycle.Temp.Vostok),#
SMA=c(Holocene.SMA.Vostok, Eemian.SMA.Vostok, Yarmouth.III.SMA.Vostok, Yarmouth.II.SMA.Vostok, Yarmouth.I.SMA.Vostok),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time.Vostok)), rep("Eemian", length(Eemian.Cycle.Time.Vostok)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time.Vostok)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time.Vostok)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time.Vostok))),#
ModAge=c(Holocene.Cycle.Time.Vostok-16889, Eemian.Cycle.Time.Vostok-16889, Yarmouth.III.Cycle.Time.Vostok-16889, Yarmouth.II.Cycle.Time.Vostok-16889, Yarmouth.I.Cycle.Time.Vostok-16889)#
#
)#
vostok.cycle.frame$Record <- rep("Vostok", length(vostok.cycle.frame[,1]))
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
interglacial.plot.all
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, -5000), breaks = seq(-5000, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
#Erase everything that comes before#
rm(list = ls(all = TRUE))#
#
#packrat::init("~/Dropbox/4.2 ky event/Data Analysis/R Code/For Distribution/Neolithic")#
#
#Compatibility#
if(.Platform$OS.type=="windows") {#
  quartz<-function() windows()#
}#
#
###Load Packages#
library(TTR)#
library(ggplot2)#
library(gridExtra)#
library(scales)#
library(gtable)#
library(wq)#
library(Bchron)#
library(plyr)#
library(bcp)#
#library(mgcv)#
library(reshape)#
library(pbapply)#
library(Cairo)#
####Function to organize plots in a window#
layOut = function(...) {#
    require(grid)#
    x <- list(...)#
    n <- max(sapply(x, function(x) max(x[[2]])))#
    p <- max(sapply(x, function(x) max(x[[3]])))#
    pushViewport(viewport(layout = grid.layout(n, p)))#
    for (i in seq_len(length(x))) {#
        print(x[[i]][[1]], vp = viewport(layout.pos.row = x[[i]][[2]],#
        layout.pos.col = x[[i]][[3]]))#
    }#
}#
###Load Data#
megafauna.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Megafauna Database/Megafauna Sigma Purge-Table 1.csv")#
human.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Humans Audited.csv")#
gisp2 <- read.csv(file="~/Dropbox/Documents/SCDPD/gisp2.csv")#
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")#
vostok <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/vostok.csv")#
###Load Calibration Curves#
intcal.13 <- read.csv(file="~/Dropbox/Documents/Peru/intcal13.csv")#
#
###Create vectors from data set by region#
#####
Transition.A.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition A")#
Transition.A.Temp <- subset(epica$Temp, epica$Stage=="Transition A")#
#
Transition.B.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition B")#
Transition.B.Temp <- subset(epica$Temp, epica$Stage=="Transition B")#
#
Transition.C.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition C")#
Transition.C.Temp <- subset(epica$Temp, epica$Stage=="Transition C")#
#
Transition.D.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition D")#
Transition.D.Temp <- subset(epica$Temp, epica$Stage=="Transition D")#
#
Transition.E.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition E")#
Transition.E.Temp <- subset(epica$Temp, epica$Stage=="Transition E")#
#
Transition.Z.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition Z")#
Transition.Z.Temp <- subset(epica$Temp, epica$Stage=="Transition Z")#
#
Transition.Y.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition Y")#
Transition.Y.Temp <- subset(epica$Temp, epica$Stage=="Transition Y")#
#
Transition.X.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition X")#
Transition.X.Temp <- subset(epica$Temp, epica$Stage=="Transition X")#
#
Transition.W.Time <- subset(epica$Time.Since.Change, epica$Stage=="Transition W")#
Transition.W.Temp <- subset(epica$Temp, epica$Stage=="Transition W")#
#
Glacial.A.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial A")#
Glacial.A.Temp <- subset(epica$Temp, epica$Stage=="Glacial A")#
#
Glacial.B.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial B")#
Glacial.B.Temp <- subset(epica$Temp, epica$Stage=="Glacial B")#
#
Glacial.C.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial C")#
Glacial.C.Temp <- subset(epica$Temp, epica$Stage=="Glacial C")#
#
Glacial.D.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial D")#
Glacial.D.Temp <- subset(epica$Temp, epica$Stage=="Glacial D")#
#
Glacial.E.Time <- subset(epica$Time.Since.Change, epica$Stage=="Glacial E")#
Glacial.E.Temp <- subset(epica$Temp, epica$Stage=="Glacial E")#
#
Interglacial.A.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial A")#
Interglacial.A.Temp <- subset(epica$Temp, epica$Stage=="Interglacial A")#
#
Interglacial.B.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial B")#
Interglacial.B.Temp <- subset(epica$Temp, epica$Stage=="Interglacial B")#
#
Interglacial.C.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial C")#
Interglacial.C.Temp <- subset(epica$Temp, epica$Stage=="Interglacial C")#
#
Interglacial.D.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial D")#
Interglacial.D.Temp <- subset(epica$Temp, epica$Stage=="Interglacial D")#
#
Interglacial.E.Time <- subset(epica$Time.Since.Change, epica$Stage=="Interglacial E")#
Interglacial.E.Temp <- subset(epica$Temp, epica$Stage=="Interglacial E")#
####United Plot#
Holocene.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Holocene")#
Holocene.Temp <- subset(epica$Temp, epica$Broad.Time.Period =="Holocene")#
#
Wisconsin.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Wisconsin")#
Wisconsin.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Wisconsin")#
#
Eemian.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Eemian")#
Eemian.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Eemian")#
#
Illinois.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Illinois")#
Illinois.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Illinois")#
#
Yarmouth.III.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Yarmouth III")#
Yarmouth.III.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Yarmouth III")#
#
Kansan.IV.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Kansan IV")#
Kansan.IV.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Kansan IV")#
#
Yarmouth.II.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Yarmouth II")#
Yarmouth.II.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Yarmouth II")#
#
Kansan.III.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Kansan III")#
Kansan.III.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Kansan III")#
#
Yarmouth.I.Time <- subset(epica$Broad.Time.Since.Change, epica$Broad.Time.Period=="Yarmouth I")#
Yarmouth.I.Temp <- subset(epica$Temp, epica$Broad.Time.Period=="Yarmouth I")#
#
Extinction.Time <- subset(epica$Broad.Time.Since.Change, epica$Extinction=="Pleistocene Extinction")#
Extinction.Temp <- subset(epica$Temp, epica$Extinction=="Pleistocene Extinction")#
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
####Cycles#
Holocene.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Holocene")#
Holocene.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Holocene")#
Holocene.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle =="Holocene")#
Holocene.Data.Density.Vostok <- 1000/length(subset(Holocene.Cycle.Time.Vostok, Holocene.Cycle.Time.Vostok > 1 & Holocene.Cycle.Time.Vostok < 1000))#
Holocene.SMA.Val.Vostok <- 1000/Holocene.Data.Density.Vostok#
Holocene.SMA.Vostok <- SMA(Holocene.Cycle.Temp.Vostok, Holocene.SMA.Val.Vostok)#
#
Eemian.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Eemian")#
Eemian.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Eemian")#
Eemian.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Eemian")#
Eemian.Data.Density.Vostok <- 1000/length(subset(Eemian.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok > 1 & Eemian.Cycle.Time.Vostok < 1000))#
Eemian.SMA.Val.Vostok <- 1000/Eemian.Data.Density.Vostok#
Eemian.SMA.Vostok <- SMA(Eemian.Cycle.Temp.Vostok, Eemian.SMA.Val.Vostok)#
#
Yarmouth.III.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density.Vostok <- 1000/length(subset(Yarmouth.III.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok > 1 & Yarmouth.III.Cycle.Time.Vostok < 1000))#
Yarmouth.III.SMA.Val.Vostok <- 1000/Yarmouth.III.Data.Density.Vostok#
Yarmouth.III.SMA.Vostok <- SMA(Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.III.SMA.Val.Vostok)#
#
Yarmouth.II.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density.Vostok <- 1000/length(subset(Yarmouth.II.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok > 1 & Yarmouth.II.Cycle.Time.Vostok < 1000))#
Yarmouth.II.SMA.Val.Vostok <- 1000/Yarmouth.II.Data.Density.Vostok#
Yarmouth.II.SMA.Vostok <- SMA(Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.II.SMA.Val.Vostok)#
#
Yarmouth.I.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density.Vostok <- 1000/length(subset(Yarmouth.I.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok > 6952 & Yarmouth.I.Cycle.Time.Vostok < 7952))#
Yarmouth.I.SMA.Val.Vostok <- 1000/Yarmouth.I.Data.Density.Vostok#
Yarmouth.I.SMA.Vostok <- SMA(Yarmouth.I.Cycle.Temp.Vostok, Yarmouth.I.SMA.Val.Vostok)#
vostok.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),#
Time=c(Holocene.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok),#
Temp=c(Holocene.Cycle.Temp.Vostok, Eemian.Cycle.Temp.Vostok, Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.I.Cycle.Temp.Vostok),#
SMA=c(Holocene.SMA.Vostok, Eemian.SMA.Vostok, Yarmouth.III.SMA.Vostok, Yarmouth.II.SMA.Vostok, Yarmouth.I.SMA.Vostok),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time.Vostok)), rep("Eemian", length(Eemian.Cycle.Time.Vostok)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time.Vostok)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time.Vostok)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time.Vostok))),#
ModAge=c(Holocene.Cycle.Time.Vostok-16889, Eemian.Cycle.Time.Vostok-16889, Yarmouth.III.Cycle.Time.Vostok-16889, Yarmouth.II.Cycle.Time.Vostok-16889, Yarmouth.I.Cycle.Time.Vostok-16889)#
#
)#
vostok.cycle.frame$Record <- rep("Vostok", length(vostok.cycle.frame[,1]))
ls(epica)
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle", "Cycle.Time", "Record", "Cycle.Proper")])
ls(vostok)
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])
head(all.data)
all.data.sub <- subset(all.data, !all.data$Cycle.Proper==NA)
head(all.data.sub)
all.data$Cycle.Proper
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")
head(all.data.sub)
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
all.plot
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)#
all.data.glacial.cycle <- rbind(epica.glacial.cycle.frame, vostok.glacial.cycle.frame)#
#
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
all.plot
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)#
all.data.glacial.cycle <- rbind(epica.glacial.cycle.frame, vostok.glacial.cycle.frame)#
#
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
all.plot
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure1.tiff", all.plot, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.01, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
#Erase everything that comes before#
rm(list = ls(all = TRUE))#
#
#packrat::init("~/Dropbox/4.2 ky event/Data Analysis/R Code/For Distribution/Neolithic")#
#
#Compatibility#
if(.Platform$OS.type=="windows") {#
  quartz<-function() windows()#
}#
#
###Load Packages#
library(TTR)#
library(ggplot2)#
library(gridExtra)#
library(scales)#
library(gtable)#
library(wq)#
library(Bchron)#
library(plyr)#
library(bcp)#
#library(mgcv)#
library(reshape)#
library(pbapply)#
library(Cairo)#
####Function to organize plots in a window#
layOut = function(...) {#
    require(grid)#
    x <- list(...)#
    n <- max(sapply(x, function(x) max(x[[2]])))#
    p <- max(sapply(x, function(x) max(x[[3]])))#
    pushViewport(viewport(layout = grid.layout(n, p)))#
    for (i in seq_len(length(x))) {#
        print(x[[i]][[1]], vp = viewport(layout.pos.row = x[[i]][[2]],#
        layout.pos.col = x[[i]][[3]]))#
    }#
}#
###Load Data#
megafauna.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Megafauna Database/Megafauna Sigma Purge-Table 1.csv")#
human.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Humans Audited.csv")#
gisp2 <- read.csv(file="~/Dropbox/Documents/SCDPD/gisp2.csv")#
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")#
vostok <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/vostok.csv")#
###Load Calibration Curves#
intcal.13 <- read.csv(file="~/Dropbox/Documents/Peru/intcal13.csv")#
#
###Create vectors from data set by region#
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))#
####Glacial Cycles#
#
Wisconsin.Cycle.Age <- subset(epica$Age, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Wisconsin")#
Wisconsin.Cycle.Temp <- subset(epica$Temp, epica$Official =="Wisconsin")#
Wisconsin.Data.Density <- 1000/length(subset(Wisconsin.Cycle.Time, Wisconsin.Cycle.Time > 1 & Wisconsin.Cycle.Time < 1000))#
Wisconsin.SMA.Val <- 1000/Wisconsin.Data.Density#
Wisconsin.SMA <- SMA(Wisconsin.Cycle.Temp, Wisconsin.SMA.Val)#
#
Illinois.Cycle.Age <- subset(epica$Age, epica$Official=="Illinois")#
Illinois.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Illinois")#
Illinois.Cycle.Temp <- subset(epica$Temp, epica$Official=="Illinois")#
Illinois.Data.Density <- 1000/length(subset(Illinois.Cycle.Time, Illinois.Cycle.Time > 1 & Illinois.Cycle.Time < 1000))#
Illinois.SMA.Val <- 1000/Illinois.Data.Density#
Illinois.SMA <- SMA(Illinois.Cycle.Temp, Illinois.SMA.Val)#
#
Kansan.IV.Cycle.Age <- subset(epica$Age, epica$Official=="Kansan IV")#
Kansan.IV.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Kansan IV")#
Kansan.IV.Cycle.Temp <- subset(epica$Temp, epica$Official=="Kansan IV")#
Kansan.IV.Data.Density <- 1000/length(subset(Kansan.IV.Cycle.Time, Kansan.IV.Cycle.Time > 1 & Kansan.IV.Cycle.Time < 1000))#
Kansan.IV.SMA.Val <- 1000/Kansan.IV.Data.Density#
Kansan.IV.SMA <- SMA(Kansan.IV.Cycle.Temp, Kansan.IV.SMA.Val)#
#
Kansan.III.Cycle.Age <- subset(epica$Age, epica$Official=="Kansan III")#
Kansan.III.Cycle.Time <- subset(epica$Time.Since.Change, epica$Official=="Kansan III")#
Kansan.III.Cycle.Temp <- subset(epica$Temp, epica$Official=="Kansan III")#
Kansan.III.Data.Density <- 1000/length(subset(Kansan.III.Cycle.Time, Kansan.III.Cycle.Time > 1 & Kansan.III.Cycle.Time < 1000))#
Kansan.III.SMA.Val <- 1000/Kansan.III.Data.Density#
Kansan.III.SMA <- SMA(Kansan.III.Cycle.Temp, Kansan.III.SMA.Val)#
#
epica.glacial.cycle.frame <- data.frame(#
Age=c(Wisconsin.Cycle.Age, Illinois.Cycle.Age, Kansan.IV.Cycle.Age, Kansan.III.Cycle.Age),#
Time=c(Wisconsin.Cycle.Time, Illinois.Cycle.Time, Kansan.IV.Cycle.Time, Kansan.III.Cycle.Time),#
Temp=c(Wisconsin.Cycle.Temp, Illinois.Cycle.Temp, Kansan.IV.Cycle.Temp, Kansan.III.Cycle.Temp),#
SMA=c(Wisconsin.SMA, Illinois.SMA, Kansan.IV.SMA, Kansan.III.SMA),#
Period=c(rep("Wisconsin", length(Wisconsin.Cycle.Time)), rep("Illinois", length(Illinois.Cycle.Time)), rep("Kansan IV", length(Kansan.IV.Cycle.Time)), rep("Kansan III", length(Kansan.III.Cycle.Time)))#
)#
epica.glacial.cycle.frame$Record <- rep("EPICA", length(epica.glacial.cycle.frame[,1]))#
###Epica Plot#
epica.plot <- qplot(epica$Age, SMA(epica$Temp, 5), geom="line",  xlab = "Cal yr BP", ylab = "Temperature Anomaly (ºC)") +#
geom_line(colour="grey50") +#
geom_line(aes(Holocene.Cycle.Age, SMA(Holocene.Cycle.Temp, 10), colour="Holocene")) + #
geom_line(aes(Eemian.Cycle.Age, SMA(Eemian.Cycle.Temp, 10), colour="Eemian")) + #
geom_line(aes(Yarmouth.III.Cycle.Age, SMA(Yarmouth.III.Cycle.Temp, 10), colour="Yarmouth III")) + #
geom_line(aes(Yarmouth.II.Cycle.Age, SMA(Yarmouth.II.Cycle.Temp, 10), colour="Yarmouth II")) +#
geom_line(aes(Yarmouth.I.Cycle.Age, SMA(Yarmouth.I.Cycle.Temp, 10), colour="Yarmouth I")) + #
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) + #
scale_x_reverse(labels=comma, limits = c(450000, 0), breaks = seq(0, 450000, 50000)) +#
theme(legend.position="none") +#
theme_light()#
###Comparative Interglacial Plot#
interglacial.plot.epica <- qplot(Holocene.Cycle.Time, SMA(Holocene.Cycle.Temp,20), geom="line",  xlab = "Years Since Preceeding Glacial Period", ylab = "Temperature Anomaly (ºC)") +#
geom_line(aes(Holocene.Cycle.Time, SMA(Holocene.Cycle.Temp, 20), colour="Holocene")) + #
geom_line(aes(Eemian.Cycle.Time, SMA(Eemian.Cycle.Temp, 20), colour="Eemian")) + #
geom_line(aes(Yarmouth.III.Cycle.Time, SMA(Yarmouth.III.Cycle.Temp, 10), colour="Yarmouth III")) + #
geom_line(aes(Yarmouth.II.Cycle.Time, SMA(Yarmouth.II.Cycle.Temp, 10), colour="Yarmouth II")) +#
geom_line(aes(Yarmouth.I.Cycle.Time, SMA(Yarmouth.I.Cycle.Temp, 10), colour="Yarmouth I")) + #
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) + #
scale_x_continuous(labels=comma, limits = c(0, 40000), breaks = seq(0, 40000, 5000)) +#
theme(legend.position=c(.945,.82)) +#
theme_light()#
###Comparative Interglacial Plot#
interglacial.plot.epica <- ggplot(epica.cycle.frame) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 40000), breaks = seq(0, 40000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)") +#
theme_light()#
interglacial.plot.epica#
###Comparative Holocene Plot#
holocene.plot.epica <- ggplot(epica.cycle.frame) +#
stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 40000), breaks = seq(0, 40000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 40000), breaks = seq(0, 40000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)") +#
guides(linetype=FALSE, colour=FALSE) +#
theme_light()#
holocene.plot.epica#
####VOSTOK#
####Cycles#
Holocene.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Holocene")#
Holocene.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Holocene")#
Holocene.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle =="Holocene")#
Holocene.Data.Density.Vostok <- 1000/length(subset(Holocene.Cycle.Time.Vostok, Holocene.Cycle.Time.Vostok > 1 & Holocene.Cycle.Time.Vostok < 1000))#
Holocene.SMA.Val.Vostok <- 1000/Holocene.Data.Density.Vostok#
Holocene.SMA.Vostok <- SMA(Holocene.Cycle.Temp.Vostok, Holocene.SMA.Val.Vostok)#
#
Eemian.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Eemian")#
Eemian.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Eemian")#
Eemian.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Eemian")#
Eemian.Data.Density.Vostok <- 1000/length(subset(Eemian.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok > 1 & Eemian.Cycle.Time.Vostok < 1000))#
Eemian.SMA.Val.Vostok <- 1000/Eemian.Data.Density.Vostok#
Eemian.SMA.Vostok <- SMA(Eemian.Cycle.Temp.Vostok, Eemian.SMA.Val.Vostok)#
#
Yarmouth.III.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density.Vostok <- 1000/length(subset(Yarmouth.III.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok > 1 & Yarmouth.III.Cycle.Time.Vostok < 1000))#
Yarmouth.III.SMA.Val.Vostok <- 1000/Yarmouth.III.Data.Density.Vostok#
Yarmouth.III.SMA.Vostok <- SMA(Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.III.SMA.Val.Vostok)#
#
Yarmouth.II.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density.Vostok <- 1000/length(subset(Yarmouth.II.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok > 1 & Yarmouth.II.Cycle.Time.Vostok < 1000))#
Yarmouth.II.SMA.Val.Vostok <- 1000/Yarmouth.II.Data.Density.Vostok#
Yarmouth.II.SMA.Vostok <- SMA(Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.II.SMA.Val.Vostok)#
#
Yarmouth.I.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density.Vostok <- 1000/length(subset(Yarmouth.I.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok > 6952 & Yarmouth.I.Cycle.Time.Vostok < 7952))#
Yarmouth.I.SMA.Val.Vostok <- 1000/Yarmouth.I.Data.Density.Vostok#
Yarmouth.I.SMA.Vostok <- SMA(Yarmouth.I.Cycle.Temp.Vostok, Yarmouth.I.SMA.Val.Vostok)#
vostok.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),#
Time=c(Holocene.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok),#
Temp=c(Holocene.Cycle.Temp.Vostok, Eemian.Cycle.Temp.Vostok, Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.I.Cycle.Temp.Vostok),#
SMA=c(Holocene.SMA.Vostok, Eemian.SMA.Vostok, Yarmouth.III.SMA.Vostok, Yarmouth.II.SMA.Vostok, Yarmouth.I.SMA.Vostok),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time.Vostok)), rep("Eemian", length(Eemian.Cycle.Time.Vostok)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time.Vostok)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time.Vostok)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time.Vostok))),#
ModAge=c(Holocene.Cycle.Time.Vostok-16889, Eemian.Cycle.Time.Vostok-16889, Yarmouth.III.Cycle.Time.Vostok-16889, Yarmouth.II.Cycle.Time.Vostok-16889, Yarmouth.I.Cycle.Time.Vostok-16889)#
#
)#
vostok.cycle.frame$Record <- rep("Vostok", length(vostok.cycle.frame[,1]))#
####Glacial Cycles#
#
Wisconsin.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Official.Name=="Wisconsin")#
Wisconsin.Cycle.Time.Vostok <- subset(vostok$Time.Since.Change, vostok$Official.Name=="Wisconsin")#
Wisconsin.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Official.Name =="Wisconsin")#
Wisconsin.Data.Density.Vostok <- 1000/length(subset(Wisconsin.Cycle.Time.Vostok, Wisconsin.Cycle.Time.Vostok > 1 & Wisconsin.Cycle.Time.Vostok < 1000))#
Wisconsin.SMA.Val.Vostok <- 1000/Wisconsin.Data.Density.Vostok#
Wisconsin.SMA.Vostok <- SMA(Wisconsin.Cycle.Temp.Vostok, Wisconsin.SMA.Val.Vostok)#
#
Illinois.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Official.Name=="Illinois")#
Illinois.Cycle.Time.Vostok <- subset(vostok$Time.Since.Change, vostok$Official.Name=="Illinois")#
Illinois.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Official.Name=="Illinois")#
Illinois.Data.Density.Vostok <- 1000/length(subset(Illinois.Cycle.Time.Vostok, Illinois.Cycle.Time.Vostok > 1 & Illinois.Cycle.Time.Vostok < 1000))#
Illinois.SMA.Val.Vostok <- 1000/Illinois.Data.Density.Vostok#
Illinois.SMA.Vostok <- SMA(Illinois.Cycle.Temp.Vostok, Illinois.SMA.Val.Vostok)#
#
Kansan.IV.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Official.Name=="Kansan IV")#
Kansan.IV.Cycle.Time.Vostok <- subset(vostok$Time.Since.Change, vostok$Official.Name=="Kansan IV")#
Kansan.IV.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Official.Name=="Kansan IV")#
Kansan.IV.Data.Density.Vostok <- 1000/length(subset(Kansan.IV.Cycle.Time.Vostok, Kansan.IV.Cycle.Time.Vostok > 1 & Kansan.IV.Cycle.Time.Vostok < 1000))#
Kansan.IV.SMA.Val.Vostok <- 1000/Kansan.IV.Data.Density.Vostok#
Kansan.IV.SMA.Vostok <- SMA(Kansan.IV.Cycle.Temp.Vostok, Kansan.IV.SMA.Val.Vostok)#
#
Kansan.III.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Official.Name=="Kansan III")#
Kansan.III.Cycle.Time.Vostok <- subset(vostok$Time.Since.Change, vostok$Official.Name=="Kansan III")#
Kansan.III.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Official.Name=="Kansan III")#
Kansan.III.Data.Density.Vostok <- 1000/length(subset(Kansan.III.Cycle.Time.Vostok, Kansan.III.Cycle.Time.Vostok > 1 & Kansan.III.Cycle.Time.Vostok < 1000))#
Kansan.III.SMA.Val.Vostok <- 1000/Kansan.III.Data.Density.Vostok#
Kansan.III.SMA.Vostok <- SMA(Kansan.III.Cycle.Temp.Vostok, Kansan.III.SMA.Val.Vostok)#
#
vostok.glacial.cycle.frame <- data.frame(#
Age=c(Wisconsin.Cycle.Age.Vostok, Illinois.Cycle.Age.Vostok, Kansan.IV.Cycle.Age.Vostok, Kansan.III.Cycle.Age.Vostok),#
Time=c(Wisconsin.Cycle.Time.Vostok, Illinois.Cycle.Time.Vostok, Kansan.IV.Cycle.Time.Vostok, Kansan.III.Cycle.Time.Vostok),#
Temp=c(Wisconsin.Cycle.Temp.Vostok, Illinois.Cycle.Temp.Vostok, Kansan.IV.Cycle.Temp.Vostok, Kansan.III.Cycle.Temp.Vostok),#
SMA=c(Wisconsin.SMA.Vostok, Illinois.SMA.Vostok, Kansan.IV.SMA.Vostok, Kansan.III.SMA.Vostok),#
Period=c(rep("Wisconsin", length(Wisconsin.Cycle.Time.Vostok)), rep("Illinois", length(Illinois.Cycle.Time.Vostok)), rep("Kansan IV", length(Kansan.IV.Cycle.Time.Vostok)), rep("Kansan III", length(Kansan.III.Cycle.Time.Vostok)))#
)#
vostok.glacial.cycle.frame$Record <- rep("Vostok", length(vostok.glacial.cycle.frame[,1]))#
###Comparative Interglacial Plot#
interglacial.plot.vostok <- ggplot(vostok.cycle.frame) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 40000), breaks = seq(0, 40000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)") +#
theme_light()#
interglacial.plot.vostok#
#
holocene.plot.vostok <- ggplot(vostok.cycle.frame) +#
stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.004607976*2, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 40000), breaks = seq(0, 40000, 5000)) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_continuous("Years since preceeding Glacial", labels=comma, limits = c(0, 40000), breaks = seq(0, 40000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)") +#
guides(linetype=FALSE, colour=FALSE) +#
theme_light()#
holocene.plot.vostok#
#
grid.arrange(interglacial.plot.epica, interglacial.plot.vostok, nrow=2)#
######All together#
#
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)#
all.data.glacial.cycle <- rbind(epica.glacial.cycle.frame, vostok.glacial.cycle.frame)#
#
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure1.tiff", all.plot, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.combined <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
#facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/HoloceneCombined.tiff", holocene.plot.combined, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
update.packages()
installed.packages()
write.table(installed.packages(), file=packates.csv, sep=",")
write.table(installed.packages(), file="packates.csv", sep=",")
shiny::runApp("~/GitHub/obsidianSource")
sudo chown paleoresearch:<your usergroup> -R <path to>/.blabla
test <- read.csv(file="~/GitHub/obsidianSource/data/globe/readydata.csv")
ls(test)
test2 <- read.csv(file="~/GitHub/obsidianSource/data/globe/Data-Table 1.csv")
ls(test2)
length(unique(test2$X))
length(Test[,1])
length(test[,1])
ls(test)
sum(test$n)
sum(test$n, na.rm=TRUE)
shiny::runApp("~/GitHub/sheetCrunch")
shiny::runApp("~/GitHub/cloudCore")
shiny::runApp("~/GitHub/sheetCrunch")
shiny::runApp("~/GitHub/CloudCore")
?pbapply
?pblapply
pblapply
shiny::runApp("~/GitHub/CloudCore")
axis.frame <- data.frame(#
x=c(1, 2, 3),#
y=c(6, 7, 8),#
z=c(14, 12, 3))#
#
 ternaryplot1 <- ggtern(data=axis.frame, aes_string(x = x, y = y, z = z)) +#
      geom_point() +#
      theme_light() +#
      theme(axis.text.x = element_text(size=15)) +#
      theme(axis.text.y = element_text(size=15)) +#
      theme(axis.title.x = element_text(size=15)) +#
      theme(axis.title.y = element_text(size=15, angle=90)) +#
      theme(plot.title=element_text(size=20)) +#
      theme(legend.title=element_text(size=15)) +#
      theme(legend.text=element_text(size=15))
axis.frame <- data.frame(#
x=c(1, 2, 3),#
y=c(6, 7, 8),#
z=c(14, 12, 3))
axis.frame
axis.frame <- data.frame(#
x=c(1, 2, 3),#
y=c(6, 7, 8),#
z=c(14, 12, 3))#
#
 ternaryplot1 <- ggtern(data=axis.frame, aes_string(x, y, z)) +#
      geom_point() +#
      theme_light() +#
      theme(axis.text.x = element_text(size=15)) +#
      theme(axis.text.y = element_text(size=15)) +#
      theme(axis.title.x = element_text(size=15)) +#
      theme(axis.title.y = element_text(size=15, angle=90)) +#
      theme(plot.title=element_text(size=20)) +#
      theme(legend.title=element_text(size=15)) +#
      theme(legend.text=element_text(size=15))
axis.frame <- data.frame(#
x=c(1, 2, 3),#
y=c(6, 7, 8),#
z=c(14, 12, 3))#
#
 ternaryplot1 <- ggtern(data=axis.frame, aes_string(x = colnames(axis.frame)[1], y = colnames(axis.frame)[2], z = colnames(axis.frame)[3])) +#
      geom_point() +#
      theme_light() +#
      theme(axis.text.x = element_text(size=15)) +#
      theme(axis.text.y = element_text(size=15)) +#
      theme(axis.title.x = element_text(size=15)) +#
      theme(axis.title.y = element_text(size=15, angle=90)) +#
      theme(plot.title=element_text(size=20)) +#
      theme(legend.title=element_text(size=15)) +#
      theme(legend.text=element_text(size=15))
ternaryplot1
update.packages()
shiny::runApp("~/GitHub/cloudFTIR")
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")
ls(epica)
epica.new <- read.csv(file="/droplet/home/paleoresearchlee/Dropbox/Documents/SCDPD/Data/epicabcp.csv")
epica.mean <- ggplot(epica, aes(Age, Temp)) +#
geom_point(alpha=0.5, aes(colour=Type)) +#
geom_line(data=subset(epica, !epica$Cycle.Proper==""), aes(Age, Temp, colour=Cycle.Proper)) +#
theme_light() +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
epica.mean
ls(epica)
ls(epica.new)
head(epica.new)
epica <- epica.new
epica.mean <- ggplot(epica, aes(Age, Temp)) +#
geom_point(alpha=0.5, aes(colour=Type)) +#
geom_line(data=subset(epica, !epica$Cycle.Proper==""), aes(Age, Temp, colour=Cycle.Proper)) +#
theme_light() +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
epica.mean
epica.mean <- ggplot(epica, aes(Age, Temp)) +#
geom_line(alpha=0.5)#
geom_line(data=subset(epica, !epica$Cycle.Proper==""), aes(Age, Temp, colour=Cycle.Proper)) +#
theme_light() +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
epica.mean <- ggplot(epica, aes(Age, Temp)) +#
geom_line(alpha=0.5) +#
geom_line(data=subset(epica, !epica$Cycle.Proper==""), aes(Age, Temp, colour=Cycle.Proper)) +#
theme_light() +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
epica.mean
epica.post <- ggplot(epica, aes(Age, PosteriorProb)) +#
geom_line(alpha=0.5) +#
geom_line(data=subset(epica, !epica$Cycle.Proper==""), aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Posterior Probability", limits=c(0, 1)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
epica.post
shiny::runApp("~/GitHub/cloudFTIR")
#Erase everything that comes before#
rm(list = ls(all = TRUE))#
#
#packrat::init("~/Dropbox/4.2 ky event/Data Analysis/R Code/For Distribution/Neolithic")#
#
#Compatibility#
if(.Platform$OS.type=="windows") {#
  quartz<-function() windows()#
}#
#
###Load Packages#
library(TTR)#
library(ggplot2)#
library(gridExtra)#
library(scales)#
library(gtable)#
library(wq)#
library(Bchron)#
library(plyr)#
library(bcp)#
#library(mgcv)#
library(reshape)#
library(pbapply)#
library(Cairo)#
####Function to organize plots in a window#
layOut = function(...) {#
    require(grid)#
    x <- list(...)#
    n <- max(sapply(x, function(x) max(x[[2]])))#
    p <- max(sapply(x, function(x) max(x[[3]])))#
    pushViewport(viewport(layout = grid.layout(n, p)))#
    for (i in seq_len(length(x))) {#
        print(x[[i]][[1]], vp = viewport(layout.pos.row = x[[i]][[2]],#
        layout.pos.col = x[[i]][[3]]))#
    }#
}#
#
bcp.core <- function (y, x = NULL, id = NULL, adj = NULL, w0 = NULL, p0 = 0.2,#
d = 10, burnin = 50, mcmc = 500, return.mcmc = FALSE, boundaryType = "node",#
p1 = 1, freqAPP = 20, cores=6L)#
{#
    "worker.bcp" <- function(mcmc, y, x, id, w0, p0, d, burnin,#
    return.mcmc, membinit, boundaryType, adj, p1, freqAPP) {#
        require(bcp)#
        if (p0 > 1 | p0 < 0 | p1 > 1 | p1 < 0)#
        stop("p0 and p1 must each be between 0 and 1.")#
        if (is.null(id)) {#
            if (is.matrix(y))#
            id <- 1:nrow(y)#
            else id <- 1:length(y)#
        }#
        if (min(id) == 1)#
        id <- id - 1#
        if (is.null(x)) {#
            if (is.null(w0))#
            w0 <- 0.2#
            if (w0 > 1 | w0 < 0)#
            stop("w0 must be between 0 and 1.")#
            if (is.vector(y))#
            y <- cbind(y)#
            if (is.null(adj)) {#
                out <- rcpp_bcpM(y, as.integer(id), as.integer(return.mcmc),#
                as.integer(burnin), as.integer(mcmc), as.double(p0),#
                as.double(w0))#
                attr(out, "structure") <- "series"#
            }#
            else {#
                if (freqAPP < 0)#
                stop("freqAPP must be a positive integer.")#
                out <- rcpp_ppm(y, as.integer(id), adj, as.integer(return.mcmc),#
                as.integer(burnin), as.integer(mcmc), as.double(p0),#
                as.double(w0), membinit, as.integer(boundaryType),#
                as.double(p1), as.integer(freqAPP))#
                attr(out, "structure") <- "graph"#
            }#
            attr(out, "model") <- "multivariate"#
            out$data <- cbind(id + 1, y)#
            if (is.null(colnames(x))) {#
                colnames(out$posterior.mean) <- paste(rep("X",#
                ncol(out$data) - 1), 1:(ncol(out$data) - 1),#
                sep = "")#
            }#
            else colnames(out$posterior.mean) <- colnames(x)#
        }#
        else {#
            if (is.vector(x))#
            x <- cbind(x)#
            if (sum(x[, 1] == 1) != nrow(x))#
            x <- cbind(1, x)#
            if (!is.double(x))#
            x <- matrix(as.double(x), nrow(x), ncol(x))#
            if (is.null(w0)) {#
                w0 <- rep(0.2, ncol(x))#
            }#
            else {#
                if (any(w0 > 1) | any(w0 < 0))#
                stop("Each element in w0 must be between 0 and 1.")#
                if (length(w0) != ncol(x)) {#
                    if (length(w0) == 1) {#
                        w0 <- rep(w0, ncol(x))#
                        print("Incorrect length for w0. I'll assume you wanted each error-to-signal ratio to be iid from U(0, w0).")#
                    }#
                    else stop("Incorrect length for w0.")#
                }#
            }#
            indmat <- t(pbapply::pbsapply(unique(id), function(y) id ==#
            y, cl=cores) * 1)#
            if (is.null(adj)) {#
                out <- rcpp_bcpR(as.double(y), x, indmat, as.integer(id),#
                as.integer(return.mcmc), as.integer(burnin),#
                as.integer(mcmc), as.double(p0), as.double(w0),#
                d)#
                out$data = cbind(id + 1, y, x[, -1])#
                attr(out, "structure") <- "series"#
            }#
            else {#
                if (freqAPP < 0)#
                stop("freqAPP must be a positive integer.")#
                out <- rcpp_ppmR(y, x, indmat, as.integer(id),#
                adj, as.integer(return.mcmc), as.integer(burnin),#
                as.integer(mcmc), as.double(p0), as.double(w0),#
                membinit, as.integer(boundaryType), d, as.double(p1),#
                as.integer(freqAPP))#
                out$data = cbind(id + 1, y, x)#
                attr(out, "structure") <- "graph"#
            }#
            attr(out, "model") <- "regression"#
            out$posterior.mean <- cbind(as.numeric(out$posterior.mean)/table(id))#
            rownames(out$posterior.mean) <- NULL#
            colnames(out$posterior.mean) <- "y"#
        }#
        if (attr(out, "structure") == "series")#
        out$posterior.prob[length(out$posterior.prob)] <- NA#
        z <- list(data = out$data, return.mcmc = return.mcmc,#
        mcmc.means = out$mcmc.means, mcmc.rhos = out$mcmc.rhos,#
        blocks = out$blocks, posterior.mean = out$posterior.mean,#
        posterior.var = out$posterior.var, posterior.prob = out$posterior.prob,#
        burnin = burnin, mcmc = mcmc, p0 = p0, w0 = w0)#
        attr(z, "model") <- attr(out, "model")#
        attr(z, "structure") <- attr(out, "structure")#
        class(z) <- "bcp"#
        return(z)#
    }#
    if (!is.null(adj)) {#
        if (boundaryType == "node") {#
            boundaryType <- 1#
        }#
        else {#
            boundaryType <- 2#
        }#
        if (is.vector(y)) {#
            dataToRank <- y#
        }#
        else if (is.matrix(y)) {#
            dataToRank <- y[, 1]#
        }#
        if (!is.null(id)) {#
            inds <- pbapply::pbsapply(1:max(id), function(g) {#
                inds <- which(id == g)#
                if (length(inds) == 1)#
                return(inds)#
                return(sample(inds, 1))#
            }, cl=cores)#
            dataToRank <- dataToRank[inds]#
        }#
        numNodes <- length(dataToRank)#
        Minit <- ceiling(sqrt(numNodes))#
        o <- rank(dataToRank, ties.method = "first")#
        membinit <- ceiling(o/Minit)#
        membinit <- pmin(membinit, Minit) - 1#
        relabelMap <- order(unique(membinit))#
        membinit <- relabelMap[membinit + 1] - 1#
    }#
    ans <- worker.bcp(mcmc, y = y, x = x, id = id, w0 = w0, p0 = p0,#
    d = d, burnin = burnin, return.mcmc = return.mcmc, membinit = membinit,#
    boundaryType = boundaryType, adj = adj, p1 = p1, freqAPP = freqAPP)#
    if (return.mcmc) {#
        if (ncol(ans$mcmc.means) > 1) {#
            mcmc.means <- vector("list", ncol(ans$mcmc.means))#
            for (i in 1:length(mcmc.means)) {#
                mcmc.means[[i]] <- matrix(ans$mcmc.means[, i],#
                nrow = burnin + mcmc, byrow = TRUE)#
            }#
        }#
        else {#
            mcmc.means <- matrix(ans$mcmc.means, nrow = burnin +#
            mcmc, byrow = TRUE)#
        }#
        ans$mcmc.means <- mcmc.means#
    }#
    return(ans)#
}#
###Load Data#
megafauna.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Megafauna Database/Megafauna Sigma Purge-Table 1.csv")#
human.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Humans Audited.csv")#
gisp2 <- read.csv(file="~/Dropbox/Documents/SCDPD/gisp2.csv")#
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")#
vostok <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/vostok.csv")#
###Load Calibration Curves#
intcal.13 <- read.csv(file="~/Dropbox/Documents/Peru/intcal13.csv")#
#
###Create vectors from data set by region#
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
###BCP Analysis#
#
holocene.bcp <- bcp(y=Holocene.Cycle.Temp, x=Holocene.Cycle.Time, p0=0.001, w0=0.01, burnin=50, mcmc=500)#
eemian.bcp <- bcp(y=Eemian.Cycle.Temp, x=Eemian.Cycle.Time, p0=0.001, w0=0.01, burnin=50, mcmc=500)#
yarmouth.iii.bcp <- bcp(y=Yarmouth.III.Cycle.Temp, x=Yarmouth.III.Cycle.Time, p0=0.001, w0=0.01, burnin=50, mcmc=500)#
yarmouth.ii.bcp <- bcp(y=Yarmouth.II.Cycle.Temp, x=Yarmouth.II.Cycle.Time, p0=0.001, w0=0.01, burnin=50, mcmc=500)#
yarmouth.i.bcp <- bcp(y=Yarmouth.I.Cycle.Temp, x=Yarmouth.I.Cycle.Time, p0=0.001, w0=0.01, burnin=50, mcmc=500)#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))#
#
epica.cycle.frame$PosteriorMean <- c(holocene.bcp$posterior.mean, eemian.bcp$posterior.mean, yarmouth.iii.bcp$posterior.mean, yarmouth.ii.bcp$posterior.mean, yarmouth.i.bcp$posterior.mean)#
epica.cycle.frame$PosteriorProb <- c(holocene.bcp$posterior.prob, eemian.bcp$posterior.prob, yarmouth.iii.bcp$posterior.prob, yarmouth.ii.bcp$posterior.prob, yarmouth.i.bcp$posterior.prob)
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(epica.cycle.frame) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
theme_light() +#
#theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
#theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=15, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
interglacial.plot.post <- ggplot(epica.cycle.frame) +#
geom_line(aes(Time, PosteriorProb, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Posterior Probability", limits=c(0, 1)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=15, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="~/Dropbox/Documents/SCDPD/Figures/epicaBCPComp.tiff",#
layOut(#
list(interglacial.plot.mean, 1:3000, 1:4000),#
list(interglacial.plot.post, 3001:5000, 25:4000)#
),#
device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
####VOSTOK#
####Cycles#
Holocene.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Holocene")#
Holocene.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Holocene")#
Holocene.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle =="Holocene")#
Holocene.Data.Density.Vostok <- 1000/length(subset(Holocene.Cycle.Time.Vostok, Holocene.Cycle.Time.Vostok > 1 & Holocene.Cycle.Time.Vostok < 1000))#
Holocene.SMA.Val.Vostok <- 1000/Holocene.Data.Density.Vostok#
Holocene.SMA.Vostok <- SMA(Holocene.Cycle.Temp.Vostok, Holocene.SMA.Val.Vostok)#
#
Eemian.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Eemian")#
Eemian.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Eemian")#
Eemian.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Eemian")#
Eemian.Data.Density.Vostok <- 1000/length(subset(Eemian.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok > 1 & Eemian.Cycle.Time.Vostok < 1000))#
Eemian.SMA.Val.Vostok <- 1000/Eemian.Data.Density.Vostok#
Eemian.SMA.Vostok <- SMA(Eemian.Cycle.Temp.Vostok, Eemian.SMA.Val.Vostok)#
#
Yarmouth.III.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density.Vostok <- 1000/length(subset(Yarmouth.III.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok > 1 & Yarmouth.III.Cycle.Time.Vostok < 1000))#
Yarmouth.III.SMA.Val.Vostok <- 1000/Yarmouth.III.Data.Density.Vostok#
Yarmouth.III.SMA.Vostok <- SMA(Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.III.SMA.Val.Vostok)#
#
Yarmouth.II.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density.Vostok <- 1000/length(subset(Yarmouth.II.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok > 1 & Yarmouth.II.Cycle.Time.Vostok < 1000))#
Yarmouth.II.SMA.Val.Vostok <- 1000/Yarmouth.II.Data.Density.Vostok#
Yarmouth.II.SMA.Vostok <- SMA(Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.II.SMA.Val.Vostok)#
#
Yarmouth.I.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density.Vostok <- 1000/length(subset(Yarmouth.I.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok > 6952 & Yarmouth.I.Cycle.Time.Vostok < 7952))#
Yarmouth.I.SMA.Val.Vostok <- 1000/Yarmouth.I.Data.Density.Vostok#
Yarmouth.I.SMA.Vostok <- SMA(Yarmouth.I.Cycle.Temp.Vostok, Yarmouth.I.SMA.Val.Vostok)#
vostok.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),#
Time=c(Holocene.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok),#
Temp=c(Holocene.Cycle.Temp.Vostok, Eemian.Cycle.Temp.Vostok, Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.I.Cycle.Temp.Vostok),#
SMA=c(Holocene.SMA.Vostok, Eemian.SMA.Vostok, Yarmouth.III.SMA.Vostok, Yarmouth.II.SMA.Vostok, Yarmouth.I.SMA.Vostok),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time.Vostok)), rep("Eemian", length(Eemian.Cycle.Time.Vostok)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time.Vostok)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time.Vostok)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time.Vostok))),#
ModAge=c(Holocene.Cycle.Time.Vostok-16889, Eemian.Cycle.Time.Vostok-16889, Yarmouth.III.Cycle.Time.Vostok-16889, Yarmouth.II.Cycle.Time.Vostok-16889, Yarmouth.I.Cycle.Time.Vostok-16889)#
#
)#
vostok.cycle.frame$Record <- rep("Vostok", length(vostok.cycle.frame[,1]))
######All together#
#
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)#
all.data.glacial.cycle <- rbind(epica.glacial.cycle.frame, vostok.glacial.cycle.frame)
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
######All together#
#
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)#
all.data.glacial.cycle <- rbind(epica.glacial.cycle.frame, vostok.glacial.cycle.frame)
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure1.tiff", all.plot, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure1.tiff", all.plot, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure1.tiff", all.plot, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure1.tiff", all.plot, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure1.tiff", all.plot, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
#Erase everything that comes before#
rm(list = ls(all = TRUE))#
#
#packrat::init("~/Dropbox/4.2 ky event/Data Analysis/R Code/For Distribution/Neolithic")#
#
#Compatibility#
if(.Platform$OS.type=="windows") {#
  quartz<-function() windows()#
}#
#
###Load Packages#
library(TTR)#
library(ggplot2)#
library(gridExtra)#
library(scales)#
library(gtable)#
library(wq)#
library(Bchron)#
library(plyr)#
library(bcp)#
#library(mgcv)#
library(reshape)#
library(pbapply)#
library(Cairo)#
####Function to organize plots in a window#
layOut = function(...) {#
    require(grid)#
    x <- list(...)#
    n <- max(sapply(x, function(x) max(x[[2]])))#
    p <- max(sapply(x, function(x) max(x[[3]])))#
    pushViewport(viewport(layout = grid.layout(n, p)))#
    for (i in seq_len(length(x))) {#
        print(x[[i]][[1]], vp = viewport(layout.pos.row = x[[i]][[2]],#
        layout.pos.col = x[[i]][[3]]))#
    }#
}#
#
bcp.core <- function (y, x = NULL, id = NULL, adj = NULL, w0 = NULL, p0 = 0.2,#
d = 10, burnin = 50, mcmc = 500, return.mcmc = FALSE, boundaryType = "node",#
p1 = 1, freqAPP = 20, cores=6L)#
{#
    "worker.bcp" <- function(mcmc, y, x, id, w0, p0, d, burnin,#
    return.mcmc, membinit, boundaryType, adj, p1, freqAPP) {#
        require(bcp)#
        if (p0 > 1 | p0 < 0 | p1 > 1 | p1 < 0)#
        stop("p0 and p1 must each be between 0 and 1.")#
        if (is.null(id)) {#
            if (is.matrix(y))#
            id <- 1:nrow(y)#
            else id <- 1:length(y)#
        }#
        if (min(id) == 1)#
        id <- id - 1#
        if (is.null(x)) {#
            if (is.null(w0))#
            w0 <- 0.2#
            if (w0 > 1 | w0 < 0)#
            stop("w0 must be between 0 and 1.")#
            if (is.vector(y))#
            y <- cbind(y)#
            if (is.null(adj)) {#
                out <- rcpp_bcpM(y, as.integer(id), as.integer(return.mcmc),#
                as.integer(burnin), as.integer(mcmc), as.double(p0),#
                as.double(w0))#
                attr(out, "structure") <- "series"#
            }#
            else {#
                if (freqAPP < 0)#
                stop("freqAPP must be a positive integer.")#
                out <- rcpp_ppm(y, as.integer(id), adj, as.integer(return.mcmc),#
                as.integer(burnin), as.integer(mcmc), as.double(p0),#
                as.double(w0), membinit, as.integer(boundaryType),#
                as.double(p1), as.integer(freqAPP))#
                attr(out, "structure") <- "graph"#
            }#
            attr(out, "model") <- "multivariate"#
            out$data <- cbind(id + 1, y)#
            if (is.null(colnames(x))) {#
                colnames(out$posterior.mean) <- paste(rep("X",#
                ncol(out$data) - 1), 1:(ncol(out$data) - 1),#
                sep = "")#
            }#
            else colnames(out$posterior.mean) <- colnames(x)#
        }#
        else {#
            if (is.vector(x))#
            x <- cbind(x)#
            if (sum(x[, 1] == 1) != nrow(x))#
            x <- cbind(1, x)#
            if (!is.double(x))#
            x <- matrix(as.double(x), nrow(x), ncol(x))#
            if (is.null(w0)) {#
                w0 <- rep(0.2, ncol(x))#
            }#
            else {#
                if (any(w0 > 1) | any(w0 < 0))#
                stop("Each element in w0 must be between 0 and 1.")#
                if (length(w0) != ncol(x)) {#
                    if (length(w0) == 1) {#
                        w0 <- rep(w0, ncol(x))#
                        print("Incorrect length for w0. I'll assume you wanted each error-to-signal ratio to be iid from U(0, w0).")#
                    }#
                    else stop("Incorrect length for w0.")#
                }#
            }#
            indmat <- t(pbapply::pbsapply(unique(id), function(y) id ==#
            y, cl=cores) * 1)#
            if (is.null(adj)) {#
                out <- rcpp_bcpR(as.double(y), x, indmat, as.integer(id),#
                as.integer(return.mcmc), as.integer(burnin),#
                as.integer(mcmc), as.double(p0), as.double(w0),#
                d)#
                out$data = cbind(id + 1, y, x[, -1])#
                attr(out, "structure") <- "series"#
            }#
            else {#
                if (freqAPP < 0)#
                stop("freqAPP must be a positive integer.")#
                out <- rcpp_ppmR(y, x, indmat, as.integer(id),#
                adj, as.integer(return.mcmc), as.integer(burnin),#
                as.integer(mcmc), as.double(p0), as.double(w0),#
                membinit, as.integer(boundaryType), d, as.double(p1),#
                as.integer(freqAPP))#
                out$data = cbind(id + 1, y, x)#
                attr(out, "structure") <- "graph"#
            }#
            attr(out, "model") <- "regression"#
            out$posterior.mean <- cbind(as.numeric(out$posterior.mean)/table(id))#
            rownames(out$posterior.mean) <- NULL#
            colnames(out$posterior.mean) <- "y"#
        }#
        if (attr(out, "structure") == "series")#
        out$posterior.prob[length(out$posterior.prob)] <- NA#
        z <- list(data = out$data, return.mcmc = return.mcmc,#
        mcmc.means = out$mcmc.means, mcmc.rhos = out$mcmc.rhos,#
        blocks = out$blocks, posterior.mean = out$posterior.mean,#
        posterior.var = out$posterior.var, posterior.prob = out$posterior.prob,#
        burnin = burnin, mcmc = mcmc, p0 = p0, w0 = w0)#
        attr(z, "model") <- attr(out, "model")#
        attr(z, "structure") <- attr(out, "structure")#
        class(z) <- "bcp"#
        return(z)#
    }#
    if (!is.null(adj)) {#
        if (boundaryType == "node") {#
            boundaryType <- 1#
        }#
        else {#
            boundaryType <- 2#
        }#
        if (is.vector(y)) {#
            dataToRank <- y#
        }#
        else if (is.matrix(y)) {#
            dataToRank <- y[, 1]#
        }#
        if (!is.null(id)) {#
            inds <- pbapply::pbsapply(1:max(id), function(g) {#
                inds <- which(id == g)#
                if (length(inds) == 1)#
                return(inds)#
                return(sample(inds, 1))#
            }, cl=cores)#
            dataToRank <- dataToRank[inds]#
        }#
        numNodes <- length(dataToRank)#
        Minit <- ceiling(sqrt(numNodes))#
        o <- rank(dataToRank, ties.method = "first")#
        membinit <- ceiling(o/Minit)#
        membinit <- pmin(membinit, Minit) - 1#
        relabelMap <- order(unique(membinit))#
        membinit <- relabelMap[membinit + 1] - 1#
    }#
    ans <- worker.bcp(mcmc, y = y, x = x, id = id, w0 = w0, p0 = p0,#
    d = d, burnin = burnin, return.mcmc = return.mcmc, membinit = membinit,#
    boundaryType = boundaryType, adj = adj, p1 = p1, freqAPP = freqAPP)#
    if (return.mcmc) {#
        if (ncol(ans$mcmc.means) > 1) {#
            mcmc.means <- vector("list", ncol(ans$mcmc.means))#
            for (i in 1:length(mcmc.means)) {#
                mcmc.means[[i]] <- matrix(ans$mcmc.means[, i],#
                nrow = burnin + mcmc, byrow = TRUE)#
            }#
        }#
        else {#
            mcmc.means <- matrix(ans$mcmc.means, nrow = burnin +#
            mcmc, byrow = TRUE)#
        }#
        ans$mcmc.means <- mcmc.means#
    }#
    return(ans)#
}#
###Load Data#
megafauna.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Megafauna Database/Megafauna Sigma Purge-Table 1.csv")#
human.data <- read.csv(file="~/Dropbox/Documents/SCDPD/Humans Audited.csv")#
gisp2 <- read.csv(file="~/Dropbox/Documents/SCDPD/gisp2.csv")#
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")#
vostok <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/vostok.csv")#
###Load Calibration Curves#
intcal.13 <- read.csv(file="~/Dropbox/Documents/Peru/intcal13.csv")#
#
###Create vectors from data set by region#
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
######All together#
#
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
####VOSTOK#
####Cycles#
Holocene.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Holocene")#
Holocene.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Holocene")#
Holocene.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle =="Holocene")#
Holocene.Data.Density.Vostok <- 1000/length(subset(Holocene.Cycle.Time.Vostok, Holocene.Cycle.Time.Vostok > 1 & Holocene.Cycle.Time.Vostok < 1000))#
Holocene.SMA.Val.Vostok <- 1000/Holocene.Data.Density.Vostok#
Holocene.SMA.Vostok <- SMA(Holocene.Cycle.Temp.Vostok, Holocene.SMA.Val.Vostok)#
#
Eemian.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Eemian")#
Eemian.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Eemian")#
Eemian.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Eemian")#
Eemian.Data.Density.Vostok <- 1000/length(subset(Eemian.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok > 1 & Eemian.Cycle.Time.Vostok < 1000))#
Eemian.SMA.Val.Vostok <- 1000/Eemian.Data.Density.Vostok#
Eemian.SMA.Vostok <- SMA(Eemian.Cycle.Temp.Vostok, Eemian.SMA.Val.Vostok)#
#
Yarmouth.III.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density.Vostok <- 1000/length(subset(Yarmouth.III.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok > 1 & Yarmouth.III.Cycle.Time.Vostok < 1000))#
Yarmouth.III.SMA.Val.Vostok <- 1000/Yarmouth.III.Data.Density.Vostok#
Yarmouth.III.SMA.Vostok <- SMA(Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.III.SMA.Val.Vostok)#
#
Yarmouth.II.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density.Vostok <- 1000/length(subset(Yarmouth.II.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok > 1 & Yarmouth.II.Cycle.Time.Vostok < 1000))#
Yarmouth.II.SMA.Val.Vostok <- 1000/Yarmouth.II.Data.Density.Vostok#
Yarmouth.II.SMA.Vostok <- SMA(Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.II.SMA.Val.Vostok)#
#
Yarmouth.I.Cycle.Age.Vostok <- subset(vostok$Age, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time.Vostok <- subset(vostok$Cycle.Time, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp.Vostok <- subset(vostok$Temp, vostok$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density.Vostok <- 1000/length(subset(Yarmouth.I.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok > 6952 & Yarmouth.I.Cycle.Time.Vostok < 7952))#
Yarmouth.I.SMA.Val.Vostok <- 1000/Yarmouth.I.Data.Density.Vostok#
Yarmouth.I.SMA.Vostok <- SMA(Yarmouth.I.Cycle.Temp.Vostok, Yarmouth.I.SMA.Val.Vostok)#
vostok.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age.Vostok, Eemian.Cycle.Age.Vostok, Yarmouth.III.Cycle.Age.Vostok, Yarmouth.II.Cycle.Age.Vostok, Yarmouth.I.Cycle.Age.Vostok),#
Time=c(Holocene.Cycle.Time.Vostok, Eemian.Cycle.Time.Vostok, Yarmouth.III.Cycle.Time.Vostok, Yarmouth.II.Cycle.Time.Vostok, Yarmouth.I.Cycle.Time.Vostok),#
Temp=c(Holocene.Cycle.Temp.Vostok, Eemian.Cycle.Temp.Vostok, Yarmouth.III.Cycle.Temp.Vostok, Yarmouth.II.Cycle.Temp.Vostok, Yarmouth.I.Cycle.Temp.Vostok),#
SMA=c(Holocene.SMA.Vostok, Eemian.SMA.Vostok, Yarmouth.III.SMA.Vostok, Yarmouth.II.SMA.Vostok, Yarmouth.I.SMA.Vostok),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time.Vostok)), rep("Eemian", length(Eemian.Cycle.Time.Vostok)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time.Vostok)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time.Vostok)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time.Vostok))),#
ModAge=c(Holocene.Cycle.Time.Vostok-16889, Eemian.Cycle.Time.Vostok-16889, Yarmouth.III.Cycle.Time.Vostok-16889, Yarmouth.II.Cycle.Time.Vostok-16889, Yarmouth.I.Cycle.Time.Vostok-16889)#
#
)#
vostok.cycle.frame$Record <- rep("Vostok", length(vostok.cycle.frame[,1]))
######All together#
#
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure1.tiff", all.plot, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure1.tiff", all.plot, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
epica <- read.csv(file="~/Dropbox/Documents/SCDPD/Data/epica.csv")
####Cycles#
Holocene.Cycle.Age <- subset(epica$Age, epica$Cycle=="Holocene")#
Holocene.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Holocene")#
Holocene.Cycle.Temp <- subset(epica$Temp, epica$Cycle =="Holocene")#
Holocene.Data.Density <- 1000/length(subset(Holocene.Cycle.Time, Holocene.Cycle.Time > 1 & Holocene.Cycle.Time < 1000))#
Holocene.SMA.Val <- 1000/Holocene.Data.Density#
Holocene.SMA <- SMA(Holocene.Cycle.Temp, Holocene.SMA.Val)#
#
Eemian.Cycle.Age <- subset(epica$Age, epica$Cycle=="Eemian")#
Eemian.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Eemian")#
Eemian.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Eemian")#
Eemian.Data.Density <- 1000/length(subset(Eemian.Cycle.Time, Eemian.Cycle.Time > 1 & Eemian.Cycle.Time < 1000))#
Eemian.SMA.Val <- 1000/Eemian.Data.Density#
Eemian.SMA <- SMA(Eemian.Cycle.Temp, Eemian.SMA.Val)#
#
Yarmouth.III.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth III")#
Yarmouth.III.Data.Density <- 1000/length(subset(Yarmouth.III.Cycle.Time, Yarmouth.III.Cycle.Time > 1 & Yarmouth.III.Cycle.Time < 1000))#
Yarmouth.III.SMA.Val <- 1000/Yarmouth.III.Data.Density#
Yarmouth.III.SMA <- SMA(Yarmouth.III.Cycle.Temp, Yarmouth.III.SMA.Val)#
#
Yarmouth.II.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth II")#
Yarmouth.II.Data.Density <- 1000/length(subset(Yarmouth.II.Cycle.Time, Yarmouth.II.Cycle.Time > 1 & Yarmouth.II.Cycle.Time < 1000))#
Yarmouth.II.SMA.Val <- 1000/Yarmouth.II.Data.Density#
Yarmouth.II.SMA <- SMA(Yarmouth.II.Cycle.Temp, Yarmouth.II.SMA.Val)#
#
Yarmouth.I.Cycle.Age <- subset(epica$Age, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Time <- subset(epica$Cycle.Time, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Cycle.Temp <- subset(epica$Temp, epica$Cycle=="Yarmouth I")#
Yarmouth.I.Data.Density <- 1000/length(subset(Yarmouth.I.Cycle.Time, Yarmouth.I.Cycle.Time > 1 & Yarmouth.I.Cycle.Time < 1000))#
Yarmouth.I.SMA.Val <- 1000/Yarmouth.I.Data.Density#
Yarmouth.I.SMA <- SMA(Yarmouth.I.Cycle.Temp, Yarmouth.I.SMA.Val)#
epica.cycle.frame <- data.frame(#
Age=c(Holocene.Cycle.Age, Eemian.Cycle.Age, Yarmouth.III.Cycle.Age, Yarmouth.II.Cycle.Age, Yarmouth.I.Cycle.Age),#
Time=c(Holocene.Cycle.Time, Eemian.Cycle.Time, Yarmouth.III.Cycle.Time, Yarmouth.II.Cycle.Time, Yarmouth.I.Cycle.Time),#
Temp=c(Holocene.Cycle.Temp, Eemian.Cycle.Temp, Yarmouth.III.Cycle.Temp, Yarmouth.II.Cycle.Temp, Yarmouth.I.Cycle.Temp),#
SMA=c(Holocene.SMA, Eemian.SMA, Yarmouth.III.SMA, Yarmouth.II.SMA, Yarmouth.I.SMA),#
Period=c(rep("Holocene", length(Holocene.Cycle.Time)), rep("Eemian", length(Eemian.Cycle.Time)), rep("Yarmouth III", length(Yarmouth.III.Cycle.Time)), rep("Yarmouth II", length(Yarmouth.II.Cycle.Time)), rep("Yarmouth I", length(Yarmouth.I.Cycle.Time))),#
ModAge=c(Holocene.Cycle.Time-16401, Eemian.Cycle.Time-16401, Yarmouth.III.Cycle.Time-16401, Yarmouth.II.Cycle.Time-16401, Yarmouth.I.Cycle.Time-16401)#
)#
epica.cycle.frame$Record <- rep("EPICA", length(epica.cycle.frame[,1]))
######All together#
#
epica$Record <- rep("EPICA", length(epica[,1]))#
vostok$Record <- rep("Vostok", length(vostok[,1]))#
#
all.data <- rbind(epica[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")], vostok[,c("Age", "Temp", "Cycle.Proper", "Cycle.Time", "Record")])#
#
all.data.sub <- subset(all.data, !all.data$Cycle.Proper=="")#
#
all.data.cycle <- rbind(epica.cycle.frame, vostok.cycle.frame)#
all.data.glacial.cycle <- rbind(epica.glacial.cycle.frame, vostok.glacial.cycle.frame)
####Timeseries#
all.plot <- ggplot(all.data) +#
geom_line(aes(Age, Temp), colour="grey80") +#
geom_line(data=all.data.sub, aes(Age, Temp, colour=Cycle.Proper)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(450000, 0)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure1.tiff", all.plot, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
###Comparative Interglacial Plot#
interglacial.plot.all <- ggplot(all.data.cycle) +#
#stat_smooth(aes(Time, Temp), method="loess", linetype="blank", span=0.005, fill="grey80") +#
geom_line(aes(Time, SMA, colour=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_x_continuous("Years following temperature increase", labels=comma, limits = c(-10000, 30000), breaks = seq(-10000, 30000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-10, 5), breaks=seq(-10, 5, 2.5)) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure2.tiff", interglacial.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)#
#
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.02, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))#
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.01, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
###Holocene Variation Plot#
holocene.plot.all <- ggplot(all.data.cycle) +#
stat_smooth(data=subset(all.data.cycle, all.data.cycle$Period!="Holocene"), aes(ModAge*-1, Temp), method="loess", linetype="blank", span=0.015, fill="grey80") +#
geom_line(aes(ModAge*-1, SMA, colour=Period, linetype=Period)) +#
scale_colour_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("#F35E5A", "#139FF3", "#DE4BEF","#FC43AE", "#18B792") ) +#
scale_linetype_manual("",#
breaks=c("Holocene", "Eemian", "Yarmouth III", "Yarmouth II", "Yarmouth I"),#
values=c("blank", "solid", "blank","blank", "blank") ) +#
scale_x_reverse("cal yr BP", labels=comma, limits = c(25000, 0), breaks = seq(0, 25000, 5000)) +#
scale_y_continuous("Temperature Anomaly (ºC)", limits=c(-12, 6), breaks=seq(-10, 5, 2.5)) +#
guides(linetype=FALSE, colour=FALSE) +#
facet_grid(Record~.) +#
theme(text = element_text(size=20)) +#
theme_light() +#
theme(axis.text.x = element_text(size=15)) +#
theme(axis.text.y = element_text(size=15)) +#
theme(axis.title.x = element_text(size=20)) +#
theme(legend.text = element_text(size=20)) +#
theme(axis.title.y = element_text(size=20, angle=90)) +#
theme(strip.text.y = element_text(size=20, angle=270))
holocene.plot.all
ggsave(file="/Users/lee/Dropbox/Documents/SCDPD/Figures/Figure3.tiff", holocene.plot.all, device="tiff", compression="lzw", type="cairo", dpi=300, width=14, height=7)
?theme
shiny::runApp("~/GitHub/Cezanne")
